{"version":3,"sources":["webpack:///src/components/content/system/folder/FolderTree.vue","webpack:///./src/components/content/system/folder/FolderTree.vue?3815","webpack:///./src/components/content/system/folder/FolderTree.vue","webpack:///./src/components/content/system/folder/FolderTree.vue?5f4b","webpack:///./src/components/content/system/folder/FolderTree.vue?8802"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA,oBADA;AAEA;AACA;AACA,cADA;AAEA,sBAFA;AAEA;AACA,cAHA;AAIA,mBAJA;AAKA,cALA;AAMA,iBANA;AAOA,qBAPA;AAOA;AACA,wBARA;AAQA;AACA,sBATA;AASA;AACA,wBAVA;AAUA;AACA,sBAXA;AAWA;AACA,sBAZA;AAYA;AACA,yBAbA;AAaA;AACA,mBAdA;AAcA;AACA,wBAfA,CAeA;;AAfA;AAiBA,GApBA;AAqBA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBALA,CAKA;AACA;AACA,KARA;;AASA;AACA;AACA;;AACA;AACA;AACA;AACA,KANA;;AAOA;AACA;AAEA,GA5CA;AA6CA,kBA7CA,4BA6CA,EA7CA,EA6CA,IA7CA,EA6CA,IA7CA,EA6CA;AACA;AACA;;AACA;AACA;AACA,mBADA;AAEA,wCAFA;AAGA;AACA,oBADA;AAEA;AAFA,SAHA;AAOA;AAPA,SASA,IATA,CASA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OAfA;AAgBA,KAjBA,MAkBA;AACA;AACA;AACA,GArEA;AAsEA;AACA;AACA;AACA,0DACA,IADA,CACA;AACA;AACA;AACA;AACA;;AACA;AACA,SALA,MAMA;AACA;AACA;AACA,OAXA,WAYA;AACA;AACA,OAdA;AAgBA,KAnBA;AAoBA;AACA;AACA;AACA;;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AAAA,gBACA,mBADA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA,KArDA;AAsDA;AACA;AACA;AACA;;AACA;AACA;AACA,OALA,CAMA;;;AACA;AACA;AACA;AACA,+BADA;AAEA,gCAFA;AAGA,2BAHA;AAIA,+BAJA;AAKA,mCALA;AAMA,iCANA;AAOA,qCAPA;AAQA,6BARA;AASA,+BATA;AAUA,6BAVA;AAWA,iCAXA;AAYA,yCAZA;AAaA,kBAbA;AAcA;AAdA;AAiBA;;AACA;AACA,KAnFA;AAoFA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA,iCADA;AAEA,kCAFA;AAGA,6BAHA;AAIA,iCAJA;AAKA,qCALA;AAMA,mCANA;AAOA,uCAPA;AAQA,+BARA;AASA,iCATA;AAUA,+BAVA;AAWA,mCAXA;AAYA,2CAZA;AAaA;AAbA;AAeA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA,KAjHA;AAmHA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA,WATA,MAUA;AACA;AACA;AACA;AACA;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA,OAvBA,MAwBA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;AACA;AACA;AACA,wBADA;AAEA,sCAFA;AAGA;AAHA,SADA;AAMA,6BANA;AAOA;AAPA;AASA;AACA,qCADA;AAEA,sBAFA;AAGA,wBAHA;AAIA,oBAJA;AAKA;AACA,qBADA;AACA;AACA,qBAFA;AAEA;AACA,uBAHA;AAGA;AACA,4BAJA,CAIA;;AAJA,SALA;AAWA;AACA,oBADA;AACA;AACA,oBAFA;AAEA;AACA,oBAHA,CAGA;;AAHA;AAXA;AAiBA,qGA5DA,CA6DA;;AACA;AACA;AACA;AACA;AACA;AACA,OAHA;AAIA;AACA;;AACA;AACA;;AACA;AAAA;AACA;AACA,WAFA,MAGA;AAAA;AACA;AACA;;AACA;AACA;AACA;AACA;AADA;AAGA;AACA,OAhBA;AAkBA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAVA;AAWA;AACA;AACA;AACA,OAFA;AAGA,KAxNA;AAyNA,eAzNA,yBAyNA;AACA;;AACA;AACA;AACA,OAFA,MAGA;AACA;AACA;AACA,KAjOA;;AAkOA;AACA;AACA;AACA;AACA,8BAHA,CAGA;;AAHA,iCAIA,CAJA;AAKA;AACA;AACA;AACA;AACA;AACA,SAJA;AANA;;AAIA;AAAA;AAOA;;AACA;;AAEA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,uBADA;AAEA,oEAFA;AAGA;AAHA;AAKA;AACA,SAPA,MAQA;AACA;AACA,uBADA;AAEA,+GAFA;AAGA;AAHA;AAKA;AACA,SAPA,MAQA;AACA;AACA;AACA;AACA;AAEA;AACA,KApRA;AAqRA,YArRA,sBAqRA;AACA;AACA;AACA;;AACA;AAAA;AACA;AACA,+DACA,IADA,CACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA,yBADA;AAEA,8CAFA;AAGA;AAHA;AAKA,WANA,MAOA;AACA;AACA;AACA,yBADA;AAEA,8CAFA;AAGA;AAHA;AAKA,WAPA,MAQA;AACA;AACA;AACA,yBADA;AAEA,8CAFA;AAGA;AAHA;AAKA;AACA,SA7BA,WA8BA;AACA;AACA,SAhCA;AAiCA,OAnCA,MAoCA;AACA;AACA,qBADA;AAEA,sBAFA;AAGA;AAHA;AAKA;AACA,KApUA;;AAqUA;AACA;AACA;;AACA;AACA;AACA,qBADA;AAEA,sDAFA;AAGA;AAHA;AAKA,OANA,MAOA;AACA,iCADA,CACA;;AACA;AAAA;AAAA;AAAA;AAAA,WAFA,CAGA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAHA;AAKA;AAEA,KA9VA;;AA+VA;AACA;AACA;;AACA;AACA;AACA,qBADA;AAEA,sDAFA;AAGA;AAHA;AAKA,OANA,MAOA;AACA,iCADA,CACA;;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAHA;AAKA;AAEA,KAvXA;AAwXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA,OAJA,MAKA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA,OAJA,MAKA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAFA,CAGA;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA,KArZA;;AAsZA;AACA;AACA,+BADA,CACA;;AACA;AACA;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAHA;AAIA;AACA;AACA,KAvaA;;AAwaA;AACA;AAAA;;AACA;AACA;;AACA;AACA;AACA;AACA,uBADA;AAEA,sFAFA;AAGA;AAHA;AAKA;AACA;AACA,SARA,MAQA;AACA;AACA,uBADA;AAEA,sFAFA;AAGA;AAHA;AAKA;AACA;AACA,SARA,MASA;AACA;AACA,uBADA;AAEA,oEAFA;AAGA;AAHA;AAKA;AACA;AACA;;AACA;AACA;AACA;AACA,qBADA;AAEA,yCAFA;AAGA;AACA,sBADA;AAEA;AAFA,WAHA;AAOA;AAPA,WASA,IATA,CASA;AACA;AACA;;AACA;AACA;AACA,wCADA;AAEA;AAFA;;AAIA,wDACA,IADA,CACA;AACA,uCADA,CACA;;AAEA;AACA;AACA,6BADA;AAEA,wDAFA;AAGA;AAHA;AAKA,eANA,MAOA;AACA;AACA,eAFA,MAGA;AACA;AACA;AACA,aAjBA,WAkBA;AACA;AACA,aApBA;;AAsBA;AACA;AACA,WA/BA,MA+BA;AACA;AACA;AACA,SA5CA;AA6CA,OA1EA,MA2EA;AACA;AACA,qBADA;AAEA,oFAFA;AAGA;AAHA;AAKA;;AACA;AACA,KA/fA;AAggBA;AACA;AACA;AACA,OAFA;AAGA,KApgBA;AAqgBA;AACA;AACA;AACA,OAFA;AAGA,KAzgBA;AA0gBA;AACA,gBA3gBA,wBA2gBA,GA3gBA,EA2gBA;AACA;AACA;AACA;AACA,OAHA,EAGA,EAHA;AAIA,KAhhBA;;AAihBA;AACA;AACA;;AACA;AACA;AACA;AACA,uBADA;AAEA,0EAFA;AAGA;AAHA;AAKA,SANA,MAOA;AACA;AACA;AACA,mCAHA,CAGA;AACA;AACA,OAbA,MAcA;AACA;AACA,qBADA;AAEA,oFAFA;AAGA;AAHA;AAKA;;AACA;AACA;AA1iBA,GAtEA;AAknBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WALA;AAOA,SAVA;AAWA;AACA;AAfA;AAlnBA,G;;;;;;;;;;;;;AC1BA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,oBAAoB,gCAAgC,eAAe,EAAE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,kBAAkB;AACxC,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,kBAAkB;AACxC,gBAAgB,uBAAuB;AACvC;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,eAAe,SAAS,yBAAyB,EAAE;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACxJA;AAAA;AAAA;AAAA;AAAqG;AACvC;AACL;;;AAGzD;AACmG;AACnG,gBAAgB,2GAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,iGAAM;AACR,EAAE,0GAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,IAAU;AACd,YAAY,mBAAO,CAAC,wGAAsE;AAC1F,cAAc,mBAAO,CAAC,+CAAK;AAC3B;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,qKAA6D,EAAE;AAAA;AACrF;AACA,gBAAgB,iGAAM;AACtB,yBAAyB,0GAAe;AACxC,OAAO;AACP,KAAK;AACL;AACA;AACA;AACe,gF;;;;;;;;;;;;ACtCf;AAAA;AAAA,wCAAsM,CAAgB,sPAAG,EAAC,C;;;;;;;;;;;;ACA1N;AAAA;AAAA;AAAA;AAAA;AAAA","file":"js/80-e935059c9645b948969b.js","sourcesContent":["<template>\r\n    <div id=\"myTree\" class=\"myTree\">\r\n        <button class=\"my-btn btn-active btn2\" @click=\"keepData();\">保存设置</button>\r\n        <button @click=\"bindClick();\" id=\"clickBtn\" style=\"display: none;\">点击</button>\r\n        <button @click=\"clickExpand();\" id=\"clickExpandBtn\" style=\"display: none;\">点击</button>\r\n        <div id=\"jsmind_container\"></div>\r\n        <div id=\"control_btn\" v-show=\"isBtnShow\">\r\n            <div class=\"up\" @click=\"addBroBefore();\" title=\"向上添加节点\">\r\n                <span class=\"up_angle\"></span>\r\n            </div>\r\n            <div class=\"down\" @click=\"addBroAfter();\" title=\"向下添加节点\">\r\n                <span class=\"down_angle\"></span>\r\n            </div>\r\n            <div class=\"right\" @click=\"addSon();\" title=\"添加子节点\">\r\n                <span class=\"right_angle\"></span>\r\n            </div>\r\n        </div>\r\n        <div id=\"wrapper\" class=\"right-click\" v-show=\"isRightClick\" ref=\"wrapper\">\r\n            <a class=\"right-click-btn\" @click=\"deleteItem();\">删除选中节点</a>\r\n            <a class=\"right-click-btn\" @click=\"editItem();\">编辑选中节点</a>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import jsMind from 'assets/lib/jsMind/jsmind.js'\r\n    export default {\r\n        name: \"FolderTree\",\r\n        data:function(){\r\n            return{\r\n                data:[],\r\n                parentFolder:[],//获取的组织列表数据\r\n                jm: null,\r\n                chooseTid:\"\",\r\n                mind:{},\r\n                options:{},\r\n                addTreeData:[],//添加的数据\r\n                changeTreeData:{},//修改的数据（新增的+修改的）\r\n                editTreeData:[],//修改的数据\r\n                deleteTreeData:[],//删除的数据\r\n                editTreeList:[],//修改的组织的id集合\r\n                isBtnShow: false,//添加节点按钮是否展示\r\n                isRightClick: false,//是否点击右键事件\r\n                scrollTree:0,//滚动距离\r\n                ifClickSave:false,//是否点击了保存按钮\r\n            }\r\n        },\r\n        mounted: function() {\r\n            let that = this;\r\n            let containerTree = document.getElementById('jsmind_container');\r\n            that.isRightClick = false;\r\n            containerTree.oncontextmenu = function(e){\r\n                if(e.target.nodeName== \"JMNODE\"){\r\n                    var e = event || window.event;\r\n                    that.isRightClick = true;\r\n                    that.$refs.wrapper.style.left = e.clientX-185+'px';\r\n                    that.$refs.wrapper.style.top = e.clientY-100 +'px';\r\n                    return false;//取消右键点击的默认事件\r\n                }\r\n            };\r\n            containerTree.onclick= function(e){\r\n                that.isRightClick = false;\r\n                that.checkSelect();\r\n                if(e.target.localName==\"jmexpander\"){\r\n                    that.isBtnShow = false;\r\n                }\r\n            };\r\n            this.chooseTid = this.$store.state.treeTid\r\n            this.getAllFolder()\r\n\r\n        },\r\n        beforeRouteLeave (to, from, next) {\r\n            if(!this.ifClickSave) this.getThisData();\r\n            let changeData = this.changeTreeData;\r\n            if(!$.isEmptyObject(changeData)){\r\n                swal({\r\n                    title: \"警告\",\r\n                    text: \"正在离开本页面，本页面内所有未保存数据都会丢失。\",\r\n                    buttons: {\r\n                        sure: \"确认\",\r\n                        cancel: \"取消\",\r\n                    },\r\n                    dangerMode: true,\r\n                })\r\n                    .then((willDelete) => {\r\n                        if (willDelete) {\r\n                            next();\r\n                        } else {\r\n                            window.history.go(1);\r\n                        }\r\n                    });\r\n            }\r\n            else{\r\n                next();\r\n            }\r\n        },\r\n        methods: {\r\n            getAllFolder: function(){\r\n                var that = this;\r\n                this.$getApi.queryAllFolder(this.$store.state.tids)\r\n                    .then(res=>{\r\n                        if(res != undefined){\r\n                            if(res.length > 0){\r\n                                that.parentFolder = that.dendrongram(res);\r\n                            }\r\n                            that.load_jsmind();\r\n                        }\r\n                        else {\r\n                           console.log('数据错误！')\r\n                        }\r\n                    })\r\n                    .catch(err=>{\r\n                        console.log('请求错误' ,err)\r\n                    })\r\n\r\n            },\r\n            // 树状图排列显示\r\n            dendrongram: function(data) {\r\n                let first = this.firstStage(data);\r\n                let arr = [];\r\n                for (let i = 0; i < 9; i++) {\r\n                    i ? arr[i] = this.childStage(data, arr[i - 1], i) : arr[i] = this.childStage(data, first, i);\r\n                    if (!arr[i].length) {\r\n                        arr.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n                for (let i = arr.length - 2; i >= 0; i--) {\r\n                    for (let j = 0, len = arr[i + 1].length; j < len; j++) {\r\n                        for (let k = 0, length = arr[i].length; k < length; k++) {\r\n                            let child = arr[i + 1][j],\r\n                                parent = arr[i][k];\r\n                            if (child.t_pid === parent.id) {\r\n                                parent['children'].push(child)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (arr.length > 0) {\r\n                    let children = arr[0];\r\n                    for (let i = 0, l = children.length; i < l; i++) {\r\n                        for (let j = 0, len = first.length; j < len; j++) {\r\n                            if (children[i].t_pid === first[j].id) {\r\n                                first[j].children.push(children[i]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return first;\r\n            },\r\n            // 第一层级别\r\n            firstStage: function(res) {\r\n                let arr = [];\r\n                let tids = [];\r\n                for (let i = 0, l = res.length; i < l; i++) {\r\n                    tids.push(res[i].t_id);\r\n                }\r\n                // console.log(tids);\r\n                for (let i = 0, l = res.length; i < l; i++) {\r\n                    // res[i].t_pid ||\r\n                    arr.push({\r\n                        name: res[i].t_name,\r\n                        topic: res[i].t_name,\r\n                        id: res[i].t_id,\r\n                        t_pid: res[i].t_pid,\r\n                        t_pName: res[i].t_pName,\r\n                        t_root: res[i].t_root,\r\n                        baseInfo: res[i].baseInfo,\r\n                        cids: res[i].cids,\r\n                        count: res[i].count,\r\n                        t_id: res[i].t_id,\r\n                        t_name: res[i].t_name,\r\n                        updateTime: res[i].updateTime,\r\n                        index: 1,\r\n                        children: []\r\n                    });\r\n\r\n                }\r\n                return arr;\r\n            },\r\n            // 除第一层后面所有级别\r\n            childStage: function(res, parents, index) {\r\n                let arr = [];\r\n                for (let i = 0, l = res.length; i < l; i++) {\r\n                    for (let j = 0, len = parents.length; j < len; j++) {\r\n                        if (res[i].t_pid === parents[j].id) {\r\n                            arr.push({\r\n                                name: res[i].t_name,\r\n                                topic: res[i].t_name,\r\n                                id: res[i].t_id,\r\n                                t_pid: res[i].t_pid,\r\n                                t_pName: res[i].t_pName,\r\n                                t_root:res[i].t_root,\r\n                                baseInfo: res[i].baseInfo,\r\n                                cids: res[i].cids,\r\n                                count: res[i].count,\r\n                                t_id: res[i].t_id,\r\n                                t_name: res[i].t_name,\r\n                                updateTime: res[i].updateTime,\r\n                                index: index + 2,\r\n                            });\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                for (let i = 0, l = arr.length; i < l; i++) {\r\n                    arr[i]['children'] = [];\r\n                }\r\n                return arr;\r\n            },\r\n\r\n            load_jsmind:function(){\r\n                $('#jsmind_container').empty();\r\n                this.data=[];\r\n                let dataResult = [];\r\n                if(this.parentFolder.length>0){\r\n                    for(let i=0;i<this.parentFolder.length;i++){\r\n                        if(this.chooseTid==\"\" || this.chooseTid==undefined){\r\n                            if(this.parentFolder[0].t_pid==0||this.parentFolder[0].t_pid==null){\r\n                                this.parentFolder[0].t_pid=\"-1\";\r\n                                this.parentFolder[0].t_pName=\"顶级组织\";\r\n                            }\r\n\r\n                            dataResult.push(this.parentFolder[0]);\r\n                            this.data={\"id\":this.parentFolder[0].t_pid, \"isroot\":true, direction:\"right\",\"topic\":this.parentFolder[0].t_pName,\"children\":dataResult};\r\n                            break;\r\n                        }\r\n                        else if(this.chooseTid!=\"\" && this.parentFolder[i].t_id==this.chooseTid){\r\n                            if(this.parentFolder[i].t_pid==0||this.parentFolder[i].t_pid==null){\r\n                                this.parentFolder[i].t_pid=\"-1\";\r\n                                this.parentFolder[i].t_pName=\"顶级组织\";\r\n                            }\r\n                            dataResult.push(this.parentFolder[i]);\r\n                            this.data={\"id\":this.parentFolder[i].t_pid, \"isroot\":true, direction:\"right\",\"topic\":this.parentFolder[i].t_pName,\"children\":dataResult};\r\n\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                else{\r\n                    this.data={\"id\":'-1', \"isroot\":true, direction:\"right\",\"topic\":'顶级组织',\"t_root\": 0,\"children\":[]};\r\n                }\r\n                if(this.data.length === 0){\r\n                    this.data={\"id\":'-1', \"isroot\":true, direction:\"right\",\"topic\":'顶级组织',\"t_root\": 0,\"children\":[]};\r\n                }\r\n                this.mind = {\r\n                    \"meta\":{\r\n                        \"name\":\"demo\",\r\n                        \"author\":\"hizzgdev@163.com\",\r\n                        \"version\":\"0.2\",\r\n                    },\r\n                    \"format\":\"node_tree\",\r\n                    \"data\":this.data,\r\n                };\r\n                this.options = {\r\n                    container:'jsmind_container',\r\n                    editable:true,\r\n                    theme:'default',\r\n                    mode:\"side\",\r\n                    view:{\r\n                        hmargin:20,        // 思维导图距容器外框的最小水平距离\r\n                        vmargin:20,         // 思维导图距容器外框的最小垂直距离\r\n                        line_width:1,       // 思维导图线条的粗细\r\n                        line_color:'#000'   // 思维导图线条的颜色\r\n                    },\r\n                    layout:{\r\n                        hspace:50,          // 节点之间的水平间距\r\n                        vspace:20,          // 节点之间的垂直间距\r\n                        pspace:24           // 节点与连接线之间的水平间距（用于容纳节点收缩/展开控制器）\r\n                    },\r\n                };\r\n                this.jm = new jsMind(this.options);\r\n                // 让 jm 显示这个 mind 即可\r\n                this.jm.show(this.mind);\r\n                var that = this;\r\n                $('jmnodes jmnode').on(\"click\",function () {\r\n                    var node=that.jm.get_selected_node();\r\n                    that.addBtn(node);\r\n                });\r\n                $('jmnodes jmnode').on(\"dblclick\",function (e) {\r\n                    var node=that.jm.get_selected_node();\r\n                    if(!node.isroot){\r\n                        let folderType;\r\n                        if(parseInt(node.data.t_root)===0 || parseInt(node.data.t_root)===3){//风电、油田\r\n                            folderType = 1;\r\n                        }\r\n                        else if(parseInt(node.data.t_root)===1 || parseInt(node.data.t_root)===2){//水泥、走行部\r\n                            folderType = 3;\r\n                        }\r\n                        let linkObj = [node.id,node.topic,folderType]\r\n                        that.$store.commit('setTreeMac', linkObj);\r\n                        that.$router.push({\r\n                            name: `machinetree`,\r\n                        })\r\n                    }\r\n                });\r\n\r\n                $('#jsmind_container').on('dragend', function(event){\r\n                    var node=that.jm.get_selected_node();\r\n                    var data = that.jm.get_data('node_array');\r\n                    if(node){\r\n                        for(let i=0;i<data.data.length;i++){\r\n                            if(that.editTreeList.indexOf(node.id)==-1 && data.data[i].id==node.id){\r\n                                that.editTreeList.push(node.id);\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n                that.checkSelect();\r\n                $('.jsmind-inner').on('scroll',function(){\r\n                    that.isBtnShow=false;\r\n                });\r\n            },\r\n            checkSelect(){\r\n                let selectNode = this.jm.get_selected_node();\r\n                if(selectNode!=null || selectNode!=undefined){\r\n                    this.isBtnShow=true;\r\n                }\r\n                else{\r\n                    this.isBtnShow=false;\r\n                }\r\n            },\r\n            /*获取数据*/\r\n            getThisData:function() {\r\n                this.changeTreeData={};\r\n                var treeData = this.jm.get_data(\"node_array\");\r\n                let folderNameList = [];//组织名集合\r\n                for(let i=0;i<treeData.data.length;i++) {\r\n                    folderNameList.push(treeData.data[i].topic);\r\n                    treeData.data.forEach(tree=>{\r\n                        if(tree.parentid===treeData.data[i].id){\r\n                            tree.t_pName = treeData.data[i].topic;\r\n                        }\r\n                    })\r\n                }\r\n                let arr = this.staticNumber(folderNameList);\r\n\r\n                for(let i=0;i<treeData.data.length;i++){\r\n                    if(treeData.data[i].id==-1 || treeData.data[i].isroot){\r\n                        continue;\r\n                    }\r\n                    let folderObj = {};\r\n                    folderObj.updateTime = \"0\";\r\n                    folderObj.t_id=treeData.data[i].id.toString();\r\n                    folderObj.t_name=treeData.data[i].topic;\r\n                    folderObj.t_pid=treeData.data[i].parentid.toString();\r\n                    folderObj.t_pName=treeData.data[i].t_pName;\r\n                    folderObj.t_root=treeData.data[i].t_root.toString();\r\n                    folderObj.baseInfo={};\r\n                    if(treeData.data[i].topic==\"\"){\r\n                        swal({\r\n                          title: \"提示\",\r\n                          text: `组织名不能为空！`,\r\n                          button: \"确认\"\r\n                        })\r\n                        return false;\r\n                    }\r\n                    else if(arr[treeData.data[i].topic]>=2){\r\n                        swal({\r\n                            title: \"提示\",\r\n                            text: `${treeData.data[i].topic}：组织名不能重复！`,\r\n                            button: \"确认\"\r\n                        })\r\n                        return false;\r\n                    }\r\n                    else{\r\n                        if(treeData.data[i].operate==1 || treeData.data[i].operate==2){\r\n                            this.changeTreeData[i]=folderObj;\r\n                        }\r\n                    }\r\n\r\n                }\r\n            },\r\n            keepData(){\r\n                this.getThisData();\r\n                this.ifClickSave = true;\r\n                var that = this;\r\n                if(!$.isEmptyObject(that.changeTreeData)){//添加组织和修改组织\r\n                    that.changeTreeData.t_ids = this.$store.state.tids;\r\n                    this.$axios.post('saveNewFolder',that.changeTreeData)\r\n                        .then(res=>{\r\n                            // that.changeTreeData={};\r\n                            for(let key in that.changeTreeData){\r\n                                delete that.changeTreeData[key];\r\n                            }\r\n                            if(res.msg==0){\r\n                                swal({\r\n                                    title: \"提示\",\r\n                                    text: `保存成功`,\r\n                                    button: \"确认\"\r\n                                })\r\n                            }\r\n                            else if(res.msg==1){\r\n                                console.log('参数为空！')\r\n                                swal({\r\n                                    title: \"提示\",\r\n                                    text: `保存失败`,\r\n                                    button: \"确认\"\r\n                                })\r\n                            }\r\n                            else if(res.msg==2){\r\n                                console.log('后台程序运行错误！')\r\n                                swal({\r\n                                    title: \"提示\",\r\n                                    text: `保存失败`,\r\n                                    button: \"确认\"\r\n                                })\r\n                            }\r\n                        })\r\n                        .catch(err=>{\r\n                            console.log('请求错误',err)\r\n                        })\r\n                }\r\n                else{\r\n                    swal({\r\n                        title: \"提示\",\r\n                        text: '保存成功',\r\n                        button: \"确认\",\r\n                    });\r\n                }\r\n            },\r\n            /*向前添加兄弟元素*/\r\n            addBroBefore:function() {\r\n                var node=this.jm.get_selected_node();\r\n                if(node && node.isroot){\r\n                   swal({\r\n                      title: \"提示\",\r\n                      text: `已是第一级！`,\r\n                      button: \"确认\"\r\n                    })\r\n                }\r\n                else if(node && !node.isroot){\r\n                    this.ifClickSave = false;//操作了新增将保存按钮变为false\r\n                    this.jm.insert_node_before(node,Math.ceil(Math.random()*10000)+\"A\", \"+\",{\"operate\":1,'t_root':node.data.t_root,'t_pName':node.parent.topic});\r\n                    // $('#control_btn').css('display','block');\r\n                    this.isBtnShow = true;\r\n                    this.addBtn(node);\r\n                    $('jmnodes jmnode').off(\"click\");\r\n                    var that = this;\r\n                    $('jmnodes jmnode').click(function () {\r\n                        var node=that.jm.get_selected_node();\r\n                        that.addBtn(node);\r\n                    })\r\n\r\n                }\r\n\r\n            },\r\n            /*向后添加兄弟元素*/\r\n            addBroAfter:function() {\r\n                var node=this.jm.get_selected_node();\r\n                if(node && node.id==\"-1\"){\r\n                    swal({\r\n                      title: \"提示\",\r\n                      text: `已是第一级！`,\r\n                      button: \"确认\"\r\n                    })\r\n                }\r\n                else if(node && !node.isroot){\r\n                    this.ifClickSave = false;//操作了新增将保存按钮变为false\r\n                    this.jm.insert_node_after(node,Math.ceil(Math.random()*10000)+\"A\", \"+\",{\"operate\":1,'t_root':node.data.t_root,'t_pName':node.parent.topic});\r\n                    $('#control_btn').css('display','block');\r\n                    this.addBtn(node);\r\n                    $('jmnodes jmnode').off(\"click\");\r\n                    var that = this;\r\n                    $('jmnodes jmnode').click(function () {\r\n                        var node=that.jm.get_selected_node();\r\n                        that.addBtn(node);\r\n                    });\r\n\r\n                }\r\n\r\n            },\r\n            addBtn:function(node) {\r\n                this.isBtnShow=true;\r\n                let scrollTopVal = $('.jsmind-inner').scrollTop();\r\n                let lay_width = parseInt(node._data.view.width+2);\r\n                let lay_height = parseInt(node._data.view.height);\r\n                let lay_left_up = parseInt(node._data.view.abs_x);\r\n                let lay_top_up = parseInt(node._data.view.abs_y+32-scrollTopVal);\r\n                let lay_left_down = parseInt(node._data.view.abs_x + node._data.view.width/2);\r\n                let lay_top_down = parseInt(node._data.view.abs_y + node._data.view.height +48-scrollTopVal);\r\n                let lay_left_left = parseInt(node._data.view.abs_x - 40);\r\n                let lay_top_left = parseInt(node._data.view.abs_y + node._data.view.height );\r\n                let lay_left_right = parseInt(node._data.view.abs_x + node._data.view.width);\r\n                let lay_top_right = parseInt(node._data.view.abs_y + node._data.view.height +16-scrollTopVal);\r\n                if(node.id==this.chooseTid || (this.chooseTid==\"\" || this.chooseTid==undefined && node.children.length==0)){\r\n                    $('.right').css({\"height\":lay_height,\"position\":\"absolute\",\"z-index\":9,\"left\":lay_left_right,\"top\":lay_top_right});\r\n                    $('.up').css({\"z-index\":-1});\r\n                    $('.down').css({\"z-index\":-1});\r\n                }\r\n                else if(node.isroot){\r\n                    $('.right').css({\"z-index\":-1});\r\n                    $('.up').css({\"z-index\":-1});\r\n                    $('.down').css({\"z-index\":-1});\r\n                }\r\n                else{\r\n                    $('.up').css({\"width\":lay_width,\"position\":\"absolute\",\"z-index\":9,\"left\":lay_left_up,\"top\":lay_top_up});\r\n                    $('.down').css({\"width\":lay_width,\"position\":\"absolute\",\"z-index\":9,\"left\":lay_left_up,\"top\":lay_top_down});\r\n                    // $('.left').css({\"position\":\"absolute\",\"z-index\":9,\"left\":lay_left_left,\"top\":lay_top_left});\r\n                    $('.right').css({\"height\":lay_height,\"position\":\"absolute\",\"z-index\":9,\"left\":lay_left_right,\"top\":lay_top_right});\r\n                }\r\n            },\r\n            /*添加子元素*/\r\n            addSon:function() {\r\n                this.ifClickSave = false;//操作了新增将保存按钮变为false\r\n                var node=this.jm.get_selected_node();\r\n                var treeData = this.jm.get_data(\"node_array\");\r\n                if(node){\r\n                    this.jm.add_node(node.id, Math.ceil(Math.random()*10000)+\"A\", \"+\",{\"operate\":1,'t_root':node.data.t_root,'t_pName':node.topic});\r\n                    $('#control_btn').css('display','block');\r\n                    this.addBtn(node);\r\n                    var that = this;\r\n                    $('jmnodes jmnode').off(\"click\");\r\n                    $('jmnodes jmnode').click(function () {\r\n                        var node=that.jm.get_selected_node();\r\n                        that.addBtn(node);\r\n                    });\r\n                    $(\"#clickExpandBtn\").trigger('click');\r\n                }\r\n            },\r\n            /*删除选中节点*/\r\n            deleteItem:function() {\r\n                var node=this.jm.get_selected_node();\r\n                var data=this.jm.get_data(\"node_array\");\r\n                if(node){\r\n                  if (node.data.cids && node.data.cids.length>0){\r\n                      swal({\r\n                          title: \"提示\",\r\n                          text: `该组织有下级组织不可删`,\r\n                          button: \"确认\"\r\n                        })\r\n                        $('#wrapper').css('display','none');\r\n                        return false;\r\n                  }else if(node.data.count==1){\r\n                        swal({\r\n                          title: \"提示\",\r\n                          text: `该组织有所属机组不可删`,\r\n                          button: \"确认\"\r\n                        })\r\n                        $('#wrapper').css('display','none');\r\n                        return false;\r\n                    }\r\n                    else if(node.isroot){\r\n                        swal({\r\n                            title: \"提示\",\r\n                            text: `顶级组织不可删除`,\r\n                            button: \"确认\"\r\n                        })\r\n                        $('#wrapper').css('display','none');\r\n                        return false;\r\n                    }\r\n                    this.deleteTreeData.push(node.id);\r\n                    let that = this;\r\n                    swal({\r\n                        title: \"警告\",\r\n                        text: \"一旦删除，该组织数据将不保留！！！确定删除吗?\",\r\n                        buttons: {\r\n                            sure: \"确认\",\r\n                            cancel: \"取消\",\r\n                        },\r\n                        dangerMode: true,\r\n                    })\r\n                        .then((willDelete) => {\r\n                            if (willDelete) {\r\n                                this.jm.remove_node(node.id);\r\n                                let paramObj = null;\r\n                                paramObj = {\r\n                                    json: this.deleteTreeData,\r\n                                    t_ids: this.$store.state.tids\r\n                                };\r\n                                this.$axios.post('deleteFolder',paramObj)\r\n                                    .then(res=>{\r\n                                        that.deleteTreeData=[];//请求过后将删除列表置空\r\n\r\n                                        if(res.msg==0){\r\n                                            swal({\r\n                                                title: \"提示\",\r\n                                                text: `删除成功！`,\r\n                                                button: \"确认\"\r\n                                            })\r\n                                        }\r\n                                        else if(res.msg==1){\r\n                                            console.log('参数为空！')\r\n                                        }\r\n                                        else if(res.msg==2){\r\n                                            console.log('后台运行错误！')\r\n                                        }\r\n                                    })\r\n                            .catch(err=>{\r\n                                    console.log('请求错误',err)\r\n                                })\r\n\r\n                                $('#control_btn').css('display','none');\r\n                                $('#clickBtn').trigger(\"click\");\r\n                            } else {\r\n                                return false;\r\n                            }\r\n                        });\r\n                }\r\n                else{\r\n                    swal({\r\n                        title: \"提示\",\r\n                        text: `请先选择想要删除的节点`,\r\n                        button: \"确认\"\r\n                    })\r\n                }\r\n                $('#wrapper').css('display','none');\r\n            },\r\n            bindClick:function() {\r\n                $('jmnodes jmnode').click(function () {\r\n                    $('#control_btn').css('display','block');\r\n                });\r\n            },\r\n            clickExpand:function(){\r\n                $('jmnodes jmexpander').click(function () {\r\n                    $('#control_btn').css('display','none');\r\n                });\r\n            },\r\n            //数组中元素的个数\r\n            staticNumber(arr) {\r\n                return arr.reduce(function (prev, next) {\r\n                    prev[next] = (prev[next] + 1) || 1;\r\n                    return prev;\r\n                }, {});\r\n            },\r\n            /*编辑选中节点*/\r\n            editItem:function() {\r\n                var node=this.jm.get_selected_node();\r\n                if(node){\r\n                    if(node.isroot){\r\n                        swal({\r\n                            title: \"提示\",\r\n                            text: `顶级组织名不可编辑`,\r\n                            button: \"确认\"\r\n                        })\r\n                    }\r\n                    else{\r\n                        this.jm.begin_edit(node.id);\r\n                        node.data.operate=2;\r\n                        this.ifClickSave = false;//操作了新增将保存按钮变为false\r\n                    }\r\n                }\r\n                else{\r\n                    swal({\r\n                        title: \"提示\",\r\n                        text: `请先选择想要编辑的节点`,\r\n                        button: \"确认\"\r\n                    })\r\n                }\r\n                $('#wrapper').css('display','none');\r\n            },\r\n        },\r\n        watch: {\r\n            data: function () {\r\n                if(this.data.length>0){\r\n                    this.$nextTick(function () {\r\n                        var that = this;\r\n                        $('jmnodes jmnode').off(\"click\");\r\n                        $('jmnodes jmnode').click(function () {\r\n                            $('#control_btn').css('display','block');\r\n                            var node = that.jm.get_selected_node();\r\n                            that.addBtn(node);\r\n                            that.checkSelect();\r\n                        });\r\n\r\n                    });\r\n                }\r\n            },\r\n\r\n        },\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"myTree\", attrs: { id: \"myTree\" } }, [\n    _c(\n      \"button\",\n      {\n        staticClass: \"my-btn btn-active btn2\",\n        on: {\n          click: function($event) {\n            return _vm.keepData()\n          }\n        }\n      },\n      [_vm._v(\"保存设置\")]\n    ),\n    _vm._v(\" \"),\n    _c(\n      \"button\",\n      {\n        staticStyle: { display: \"none\" },\n        attrs: { id: \"clickBtn\" },\n        on: {\n          click: function($event) {\n            return _vm.bindClick()\n          }\n        }\n      },\n      [_vm._v(\"点击\")]\n    ),\n    _vm._v(\" \"),\n    _c(\n      \"button\",\n      {\n        staticStyle: { display: \"none\" },\n        attrs: { id: \"clickExpandBtn\" },\n        on: {\n          click: function($event) {\n            return _vm.clickExpand()\n          }\n        }\n      },\n      [_vm._v(\"点击\")]\n    ),\n    _vm._v(\" \"),\n    _c(\"div\", { attrs: { id: \"jsmind_container\" } }),\n    _vm._v(\" \"),\n    _c(\n      \"div\",\n      {\n        directives: [\n          {\n            name: \"show\",\n            rawName: \"v-show\",\n            value: _vm.isBtnShow,\n            expression: \"isBtnShow\"\n          }\n        ],\n        attrs: { id: \"control_btn\" }\n      },\n      [\n        _c(\n          \"div\",\n          {\n            staticClass: \"up\",\n            attrs: { title: \"向上添加节点\" },\n            on: {\n              click: function($event) {\n                return _vm.addBroBefore()\n              }\n            }\n          },\n          [_c(\"span\", { staticClass: \"up_angle\" })]\n        ),\n        _vm._v(\" \"),\n        _c(\n          \"div\",\n          {\n            staticClass: \"down\",\n            attrs: { title: \"向下添加节点\" },\n            on: {\n              click: function($event) {\n                return _vm.addBroAfter()\n              }\n            }\n          },\n          [_c(\"span\", { staticClass: \"down_angle\" })]\n        ),\n        _vm._v(\" \"),\n        _c(\n          \"div\",\n          {\n            staticClass: \"right\",\n            attrs: { title: \"添加子节点\" },\n            on: {\n              click: function($event) {\n                return _vm.addSon()\n              }\n            }\n          },\n          [_c(\"span\", { staticClass: \"right_angle\" })]\n        )\n      ]\n    ),\n    _vm._v(\" \"),\n    _c(\n      \"div\",\n      {\n        directives: [\n          {\n            name: \"show\",\n            rawName: \"v-show\",\n            value: _vm.isRightClick,\n            expression: \"isRightClick\"\n          }\n        ],\n        ref: \"wrapper\",\n        staticClass: \"right-click\",\n        attrs: { id: \"wrapper\" }\n      },\n      [\n        _c(\n          \"a\",\n          {\n            staticClass: \"right-click-btn\",\n            on: {\n              click: function($event) {\n                return _vm.deleteItem()\n              }\n            }\n          },\n          [_vm._v(\"删除选中节点\")]\n        ),\n        _vm._v(\" \"),\n        _c(\n          \"a\",\n          {\n            staticClass: \"right-click-btn\",\n            on: {\n              click: function($event) {\n                return _vm.editItem()\n              }\n            }\n          },\n          [_vm._v(\"编辑选中节点\")]\n        )\n      ]\n    )\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./FolderTree.vue?vue&type=template&id=aa356dda&scoped=true&\"\nimport script from \"./FolderTree.vue?vue&type=script&lang=js&\"\nexport * from \"./FolderTree.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"aa356dda\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\工作\\\\CCCCCCCCCC\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('aa356dda')) {\n      api.createRecord('aa356dda', component.options)\n    } else {\n      api.reload('aa356dda', component.options)\n    }\n    module.hot.accept(\"./FolderTree.vue?vue&type=template&id=aa356dda&scoped=true&\", function () {\n      api.rerender('aa356dda', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/components/content/system/folder/FolderTree.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FolderTree.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FolderTree.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FolderTree.vue?vue&type=template&id=aa356dda&scoped=true&\""],"sourceRoot":""}