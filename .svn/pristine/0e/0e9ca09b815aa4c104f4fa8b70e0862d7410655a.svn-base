{"version":3,"sources":["webpack:///./src/assets/lib/jsMind/jsmind.js"],"names":["$w","__name__","__version__","__author__","_noop","logger","console","log","debug","error","warn","info","module","exports","$d","document","$g","id","getElementById","$c","tag","createElement","$t","n","t","hasChildNodes","firstChild","nodeValue","appendChild","createTextNode","$h","HTMLElement","innerHTML","$i","el","nodeType","style","ownerDocument","String","prototype","startsWith","p","slice","length","DEFAULT_OPTIONS","container","editable","theme","mode","support_html","view","hmargin","vmargin","line_width","line_color","layout","hspace","vspace","pspace","default_event_handle","enable_mousedown_handle","enable_click_handle","enable_dblclick_handle","shortcut","enable","handles","mapping","addchild","addbrother","editnode","delnode","toggle","left","up","right","down","jm","options","current","version","opts","util","json","merge","inited","mind","event_handles","init","direction","center","event_type","show","resize","edit","select","node","sId","iIndex","sTopic","oData","bIsRoot","oParent","eDirection","bExpanded","index","topic","data","isroot","parent","expanded","children","_data","compare","node1","node2","r","i1","i2","inherited","pnode","pid","get_location","vd","x","abs_x","y","abs_y","get_size","w","width","h","height","name","author","root","selected","nodes","get_node","nodeid","set_root","_put_node","add_node","parent_node","idx","is_node","the_parent_node","nodeindex","d","isNaN","children_len","i","push","_reindex","insert_node_before","node_before","the_node_before","node_index","get_node_before","the_node","insert_node_after","node_after","the_node_after","get_node_after","brothers","move_node","beforeid","parentid","_move_node","_flow_node_direction","len","_move_node_internal","sibling","si","splice","remove_node","ci","k","sort","format","node_tree","example","get_mind","source","df","meta","_parse","get_data","_buildnode","node_root","_extract_data","_extract_subnode","node_json","node_parent","o","node_data","node_array","_array","narray","reverse","root_id","_extract_root","root_json","extract_count","node_direction","sub_extract_count","_array_node","freemind","xml","xml_doc","_parse_xml","xml_root","_find_root","_load_node","xmllines","_buildmap","join","window","DOMParser","parser","parseFromString","ActiveXObject","async","loadXML","childNodes","tagName","ns","parent_id","xml_node","node_id","getAttribute","node_topic","topic_children","topic_child","textContent","_load_attributes","node_expanded","node_position","child","attr","attr_data","pos","ajax","_xhr","xhr","XMLHttpRequest","e","_eurl","url","encodeURIComponent","request","param","method","callback","fail_callback","a","tmp_param","onreadystatechange","readyState","status","string2json","responseText","open","setRequestHeader","send","get","post","dom","add_event","addEventListener","attachEvent","canvas","bezierto","ctx","x1","y1","x2","y2","beginPath","moveTo","bezierCurveTo","stroke","lineto","lineTo","clear","clearRect","file","read","file_data","fn_callback","reader","FileReader","onload","result","readAsText","save","type","blob","Blob","BlobBuilder","MozBlobBuilder","WebKitBlobBuilder","MSBlobBuilder","bb","append","getBlob","navigator","msSaveBlob","URL","webkitURL","bloburl","createObjectURL","anchor","visibility","href","download","body","evt","createEvent","initEvent","dispatchEvent","removeChild","location","json2string","JSON","json_str","stringify","parse","b","Object","toString","call","toLowerCase","uuid","newid","Date","getTime","Math","random","substr","text","is_empty","s","replace","opts_layout","opts_view","data_provider","layout_provider","view_provider","shortcut_provider","_event_bind","init_plugins","enable_edit","disable_edit","enable_event_handle","event_handle","disable_event_handle","get_editable","set_theme","theme_old","reset_theme","reset_custom_style","mousedown_handle","click_handle","dblclick_handle","element","target","event","srcElement","get_binded_nodeid","select_node","select_clear","isexpander","is_expander","toggle_node","begin_edit","edit_node_begin","end_edit","edit_node_end","save_location","relayout","restore_location","expand_node","collapse_node","expand_all","collapse_all","expand_to_depth","depth","_reset","reset","_show","m","load","invoke_event_handle","get_meta","data_format","get_root","reset_node_custom_style","afterid","update_node","is_visible","get_selected_node","is_node_visible","find_node_before","c","prev","ni","find_node_after","getthis","set_node_color","bgcolor","fgcolor","set_node_font_style","size","weight","set_node_background_image","image","rotation","set_node_background_rotation","add_event_listener","j","setTimeout","_invoke_event_handle","l","mind_data","isside","bounds","cache_valid","layout_direction","layout_offset","_layout_direction_root","layout_data","children_count","side_index","_layout_direction_side","subnode","offset_x","offset_y","outer_height","left_nodes","right_nodes","unshift","outer_height_left","_layout_offset_subnodes","outer_height_right","max","total_height","nodes_count","node_outer_height","base_y","pd","set_visible","middle_height","_layout_offset_subnodes_height","get_node_offset","offset_cache","_offset_","offset_p","get_node_point","view_data","get_node_point_in","get_node_point_out","pout_cache","_pout_","get_expander_point","ex_p","ceil","get_min_size","pout","part_layout","target_depth","curr_nodes","curr_depth","root_layout_data","visible","is_expand","e_panel","e_nodes","e_canvas","canvas_ctx","selected_node","editing_node","e_editor","className","actualZoom","zoomStep","minZoom","maxZoom","v","keyCode","stopPropagation","init_canvas","obj","event_name","parentElement","clear_lines","clear_nodes","theme_name","init_nodes","expand_size","min_size","min_width","min_height","client_w","clientWidth","client_h","clientHeight","getContext","init_nodes_size","doc_frag","createDocumentFragment","create_node_element","d_e","setAttribute","expander","_reset_node_custom_style","clear_node_custom_style","get_editing_node","is_editing","ncs","getComputedStyle","value","parseInt","getPropertyValue","zIndex","focus","myEvent","Event","get_view_offset","_x","_y","show_nodes","show_lines","zoomIn","setZoom","zoomOut","zoom","transform","_center_root","outer_w","outer_h","_offset","scrollLeft","scrollTop","keep_center","_saved_location","top","node_element","p_expander","expander_text","display","backgroundColor","color","fontSize","fontWeight","fontStyle","backgroundImage","img","Image","drawImage","scaledImageData","toDataURL","src","backgroundSize","pin","draw_line","offset","strokeStyle","lineWidth","lineCap","_mapping","handler","bind","handle_addchild","handle_addbrother","handle_editnode","handle_delnode","handle_toggle","handle_up","handle_down","handle_left","handle_right","handle","enable_shortcut","disable_shortcut","kc","_jm","preventDefault","up_node","np","down_node","_handle_direction","floor","childrencount","plugin","plugins","register_plugin","sender","_init_plugins","fn_init","define","global"],"mappings":"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","file":"js/14-9d88d1f28ba3314a8fa6.js","sourcesContent":["/*\n * Released under BSD License\n * Copyright (c) 2014-2016 hizzgdev@163.com\n *\n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\n; (function ($w) {\n    'use strict';\n    // set 'jsMind' as the library name.\n    // __name__ should be a const value, Never try to change it easily.\n    var __name__ = 'jsMind';\n    // library version\n    var __version__ = '0.4.6';\n    // author\n    var __author__ = 'hizzgdev@163.com';\n\n    // an noop function define\n    var _noop = function () { };\n    var logger = (typeof console === 'undefined') ? {\n        log: _noop, debug: _noop, error: _noop, warn: _noop, info: _noop\n    } : console;\n\n    // check global variables\n    if (typeof module === 'undefined' || !module.exports) {\n        if (typeof $w[__name__] != 'undefined') {\n            logger.log(__name__ + ' has been already exist.');\n            return;\n        }\n    }\n\n    // shortcut of methods in dom\n    var $d = $w.document;\n    var $g = function (id) { return $d.getElementById(id); };\n    var $c = function (tag) { return $d.createElement(tag); };\n    var $t = function (n, t) { if (n.hasChildNodes()) { n.firstChild.nodeValue = t; } else { n.appendChild($d.createTextNode(t)); } };\n\n    var $h = function (n, t) {\n        if (t instanceof HTMLElement) {\n            n.innerHTML = '';\n            n.appendChild(t)\n        } else {\n            n.innerHTML = t;\n        }\n    };\n    // detect isElement\n    var $i = function (el) { return !!el && (typeof el === 'object') && (el.nodeType === 1) && (typeof el.style === 'object') && (typeof el.ownerDocument === 'object'); };\n    if (typeof String.prototype.startsWith != 'function') { String.prototype.startsWith = function (p) { return this.slice(0, p.length) === p; }; }\n\n    var DEFAULT_OPTIONS = {\n        container: '',   // id of the container\n        editable: false, // you can change it in your options\n        theme: null,\n        mode: 'full',     // full or side\n        support_html: true,\n\n        view: {\n            hmargin: 100,\n            vmargin: 50,\n            line_width: 2,\n            line_color: '#555'\n        },\n        layout: {\n            hspace: 30,\n            vspace: 20,\n            pspace: 13\n        },\n        default_event_handle: {\n            enable_mousedown_handle: true,\n            enable_click_handle: true,\n            enable_dblclick_handle: true\n        },\n        shortcut: {\n            enable: true,\n            handles: {\n            },\n            mapping: {\n                addchild: 45, // Insert\n                addbrother: 13, // Enter\n                editnode: 113,// F2\n                delnode: 46, // Delete\n                toggle: 32, // Space\n                left: 37, // Left\n                up: 38, // Up\n                right: 39, // Right\n                down: 40, // Down\n            }\n        },\n    };\n\n    // core object\n    var jm = function (options) {\n        jm.current = this;\n\n        this.version = __version__;\n        var opts = {};\n        jm.util.json.merge(opts, DEFAULT_OPTIONS);\n        jm.util.json.merge(opts, options);\n\n        if (!opts.container) {\n            logger.error('the options.container should not be null or empty.');\n            return;\n        }\n        this.options = opts;\n        this.inited = false;\n        this.mind = null;\n        this.event_handles = [];\n        this.init();\n    };\n\n    // ============= static object =============================================\n    jm.direction = { left: -1, center: 0, right: 1 };\n    jm.event_type = { show: 1, resize: 2, edit: 3, select: 4 };\n\n    jm.node = function (sId, iIndex, sTopic, oData, bIsRoot, oParent, eDirection, bExpanded) {\n        if (!sId) { logger.error('invalid nodeid'); return; }\n        if (typeof iIndex != 'number') { logger.error('invalid node index'); return; }\n        if (typeof bExpanded === 'undefined') { bExpanded = true; }\n        this.id = sId;\n        this.index = iIndex;\n        this.topic = sTopic;\n        this.data = oData || {};\n        this.isroot = bIsRoot;\n        this.parent = oParent;\n        this.direction = eDirection;\n        this.expanded = !!bExpanded;\n        this.children = [];\n        this._data = {};\n    };\n\n    jm.node.compare = function (node1, node2) {\n        // '-1' is alwary the last\n        var r = 0;\n        var i1 = node1.index;\n        var i2 = node2.index;\n        if (i1 >= 0 && i2 >= 0) {\n            r = i1 - i2;\n        } else if (i1 == -1 && i2 == -1) {\n            r = 0;\n        } else if (i1 == -1) {\n            r = 1;\n        } else if (i2 == -1) {\n            r = -1;\n        } else {\n            r = 0;\n        }\n        //logger.debug(i1+' <> '+i2+'  =  '+r);\n        return r;\n    };\n\n    jm.node.inherited = function (pnode, node) {\n        if (!!pnode && !!node) {\n            if (pnode.id === node.id) {\n                return true;\n            }\n            if (pnode.isroot) {\n                return true;\n            }\n            var pid = pnode.id;\n            var p = node;\n            while (!p.isroot) {\n                p = p.parent;\n                if (p.id === pid) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    jm.node.prototype = {\n        get_location: function () {\n            var vd = this._data.view;\n            return {\n                x: vd.abs_x,\n                y: vd.abs_y\n            };\n        },\n        get_size: function () {\n            var vd = this._data.view;\n            return {\n                w: vd.width,\n                h: vd.height\n            }\n        }\n    };\n\n\n    jm.mind = function () {\n        this.name = null;\n        this.author = null;\n        this.version = null;\n        this.root = null;\n        this.selected = null;\n        this.nodes = {};\n    };\n\n    jm.mind.prototype = {\n        get_node: function (nodeid) {\n            if (nodeid in this.nodes) {\n                return this.nodes[nodeid];\n            } else {\n                logger.warn('the node[id=' + nodeid + '] can not be found');\n                return null;\n            }\n        },\n\n        set_root: function (nodeid, topic, data) {\n            if (this.root == null) {\n                this.root = new jm.node(nodeid, 0, topic, data, true);\n                this._put_node(this.root);\n            } else {\n                logger.error('root node is already exist');\n            }\n        },\n\n        add_node: function (parent_node, nodeid, topic, data, idx, direction, expanded) {\n            if (!jm.util.is_node(parent_node)) {\n                var the_parent_node = this.get_node(parent_node);\n                if (!the_parent_node) {\n                    logger.error('the parent_node[id=' + parent_node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.add_node(the_parent_node, nodeid, topic, data, idx, direction, expanded);\n                }\n            }\n            var nodeindex = idx || -1;\n            var node = null;\n            if (parent_node.isroot) {\n                var d = jm.direction.right;\n                if (isNaN(direction)) {\n                    var children = parent_node.children;\n                    var children_len = children.length;\n                    var r = 0;\n                    for (var i = 0; i < children_len; i++) { if (children[i].direction === jm.direction.left) { r--; } else { r++; } }\n                    d = (children_len > 1 && r > 0) ? jm.direction.left : jm.direction.right\n                } else {\n                    d = (direction != jm.direction.left) ? jm.direction.right : jm.direction.left;\n                }\n                node = new jm.node(nodeid, nodeindex, topic, data, false, parent_node, d, expanded);\n            } else {\n                node = new jm.node(nodeid, nodeindex, topic, data, false, parent_node, parent_node.direction, expanded);\n            }\n            if (this._put_node(node)) {\n                parent_node.children.push(node);\n                this._reindex(parent_node);\n            } else {\n                logger.error('fail, the nodeid \\'' + node.id + '\\' has been already exist.');\n                node = null;\n            }\n            return node;\n        },\n\n        insert_node_before: function (node_before, nodeid, topic, data) {\n            if (!jm.util.is_node(node_before)) {\n                var the_node_before = this.get_node(node_before);\n                if (!the_node_before) {\n                    logger.error('the node_before[id=' + node_before + '] can not be found.');\n                    return null;\n                } else {\n                    return this.insert_node_before(the_node_before, nodeid, topic, data);\n                }\n            }\n            var node_index = node_before.index - 0.5;\n            return this.add_node(node_before.parent, nodeid, topic, data, node_index);\n        },\n\n        get_node_before: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_before(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var idx = node.index - 2;\n            if (idx >= 0) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        insert_node_after: function (node_after, nodeid, topic, data) {\n            if (!jm.util.is_node(node_after)) {\n                var the_node_after = this.get_node(node_before);\n                if (!the_node_after) {\n                    logger.error('the node_after[id=' + node_after + '] can not be found.');\n                    return null;\n                } else {\n                    return this.insert_node_after(the_node_after, nodeid, topic, data);\n                }\n            }\n            var node_index = node_after.index + 0.5;\n            return this.add_node(node_after.parent, nodeid, topic, data, node_index);\n        },\n\n        get_node_after: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_after(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var idx = node.index;\n            var brothers = node.parent.children;\n            if (brothers.length >= idx) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        move_node: function (node, beforeid, parentid, direction) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.move_node(the_node, beforeid, parentid, direction);\n                }\n            }\n            if (!parentid) {\n                parentid = node.parent.id;\n            }\n            return this._move_node(node, beforeid, parentid, direction);\n        },\n\n        _flow_node_direction: function (node, direction) {\n            if (typeof direction === 'undefined') {\n                direction = node.direction;\n            } else {\n                node.direction = direction;\n            }\n            var len = node.children.length;\n            while (len--) {\n                this._flow_node_direction(node.children[len], direction);\n            }\n        },\n\n        _move_node_internal: function (node, beforeid) {\n            if (!!node && !!beforeid) {\n                if (beforeid == '_last_') {\n                    node.index = -1;\n                    this._reindex(node.parent);\n                } else if (beforeid == '_first_') {\n                    node.index = 0;\n                    this._reindex(node.parent);\n                } else {\n                    var node_before = (!!beforeid) ? this.get_node(beforeid) : null;\n                    if (node_before != null && node_before.parent != null && node_before.parent.id == node.parent.id) {\n                        node.index = node_before.index - 0.5;\n                        this._reindex(node.parent);\n                    }\n                }\n            }\n            return node;\n        },\n\n        _move_node: function (node, beforeid, parentid, direction) {\n            if (!!node && !!parentid) {\n                if (node.parent.id != parentid) {\n                    // remove from parent's children\n                    var sibling = node.parent.children;\n                    var si = sibling.length;\n                    while (si--) {\n                        if (sibling[si].id == node.id) {\n                            sibling.splice(si, 1);\n                            break;\n                        }\n                    }\n                    node.parent = this.get_node(parentid);\n                    node.parent.children.push(node);\n                }\n\n                if (node.parent.isroot) {\n                    if (direction == jm.direction.left) {\n                        node.direction = direction;\n                    } else {\n                        node.direction = jm.direction.right;\n                    }\n                } else {\n                    node.direction = node.parent.direction;\n                }\n                this._move_node_internal(node, beforeid);\n                this._flow_node_direction(node);\n            }\n            return node;\n        },\n\n        remove_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.remove_node(the_node);\n                }\n            }\n            if (!node) {\n                logger.error('fail, the node can not be found');\n                return false;\n            }\n            if (node.isroot) {\n                logger.error('fail, can not remove root node');\n                return false;\n            }\n            if (this.selected != null && this.selected.id == node.id) {\n                this.selected = null;\n            }\n            // clean all subordinate nodes\n            var children = node.children;\n            var ci = children.length;\n            while (ci--) {\n                this.remove_node(children[ci]);\n            }\n            // clean all children\n            children.length = 0;\n            // remove from parent's children\n            var sibling = node.parent.children;\n            var si = sibling.length;\n            while (si--) {\n                if (sibling[si].id == node.id) {\n                    sibling.splice(si, 1);\n                    break;\n                }\n            }\n            // remove from global nodes\n            delete this.nodes[node.id];\n            // clean all properties\n            for (var k in node) {\n                delete node[k];\n            }\n            // remove it's self\n            node = null;\n            //delete node;\n            return true;\n        },\n\n        _put_node: function (node) {\n            if (node.id in this.nodes) {\n                logger.warn('the nodeid \\'' + node.id + '\\' has been already exist.');\n                return false;\n            } else {\n                this.nodes[node.id] = node;\n                return true;\n            }\n        },\n\n        _reindex: function (node) {\n            if (node instanceof jm.node) {\n                node.children.sort(jm.node.compare);\n                for (var i = 0; i < node.children.length; i++) {\n                    node.children[i].index = i + 1;\n                }\n            }\n        },\n    };\n\n    jm.format = {\n        node_tree: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_tree\",\n                \"data\": { \"id\": \"root\", \"topic\": \"jsMind Example\" }\n            },\n            get_mind: function (source) {\n                var df = jm.format.node_tree;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n            get_data: function (mind) {\n                var df = jm.format.node_tree;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_tree';\n                json.data = df._buildnode(mind.root);\n                return json;\n            },\n\n            _parse: function (mind, node_root) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_root);\n                mind.set_root(node_root.id, node_root.topic, data);\n                if ('children' in node_root) {\n                    var children = node_root.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, mind.root, children[i]);\n                    }\n                }\n            },\n\n            _extract_data: function (node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'children' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _extract_subnode: function (mind, node_parent, node_json) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_json);\n                var d = null;\n                if (node_parent.isroot) {\n                    d = node_json.direction == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                var node = mind.add_node(node_parent, node_json.id, node_json.topic, data, null, d, node_json.expanded);\n                if ('children' in node_json) {\n                    var children = node_json.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, node, children[i]);\n                    }\n                }\n            },\n\n            _buildnode: function (node) {\n                var df = jm.format.node_tree;\n                if (!(node instanceof jm.node)) { return; }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                var children = node.children;\n                if (children.length > 0) {\n                    o.children = [];\n                    for (var i = 0; i < children.length; i++) {\n                        o.children.push(df._buildnode(children[i]));\n                    }\n                }\n                return o;\n            }\n        },\n\n        node_array: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_array\",\n                \"data\": [\n                    { \"id\": \"root\", \"topic\": \"jsMind Example\", \"isroot\": true }\n                ]\n            },\n\n            get_mind: function (source) {\n                var df = jm.format.node_array;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n\n            get_data: function (mind) {\n                var df = jm.format.node_array;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_array';\n                json.data = [];\n                df._array(mind, json.data);\n                return json;\n            },\n\n            _parse: function (mind, node_array) {\n                var df = jm.format.node_array;\n                var narray = node_array.slice(0);\n                // reverse array for improving looping performance\n                narray.reverse();\n                var root_id = df._extract_root(mind, narray);\n                if (!!root_id) {\n                    df._extract_subnode(mind, root_id, narray);\n                } else {\n                    logger.error('root node can not be found');\n                }\n            },\n\n            _extract_root: function (mind, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                while (i--) {\n                    if ('isroot' in node_array[i] && node_array[i].isroot) {\n                        var root_json = node_array[i];\n                        var data = df._extract_data(root_json);\n                        mind.set_root(root_json.id, root_json.topic, data);\n                        node_array.splice(i, 1);\n                        return root_json.id;\n                    }\n                }\n                return null;\n            },\n\n            _extract_subnode: function (mind, parentid, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                var node_json = null;\n                var data = null;\n                var extract_count = 0;\n                while (i--) {\n                    node_json = node_array[i];\n                    if (node_json.parentid == parentid) {\n                        data = df._extract_data(node_json);\n                        var d = null;\n                        var node_direction = node_json.direction;\n                        if (!!node_direction) {\n                            d = node_direction == 'left' ? jm.direction.left : jm.direction.right;\n                        }\n                        mind.add_node(parentid, node_json.id, node_json.topic, data, null, d, node_json.expanded);\n                        node_array.splice(i, 1);\n                        extract_count++;\n                        var sub_extract_count = df._extract_subnode(mind, node_json.id, node_array);\n                        if (sub_extract_count > 0) {\n                            // reset loop index after extract subordinate node\n                            i = node_array.length;\n                            extract_count += sub_extract_count;\n                        }\n                    }\n                }\n                return extract_count;\n            },\n\n            _extract_data: function (node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'parentid' || k == 'isroot' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _array: function (mind, node_array) {\n                var df = jm.format.node_array;\n                df._array_node(mind.root, node_array);\n            },\n\n            _array_node: function (node, node_array) {\n                var df = jm.format.node_array;\n                if (!(node instanceof jm.node)) { return; }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent) {\n                    o.parentid = node.parent.id;\n                }\n                if (node.isroot) {\n                    o.isroot = true;\n                }\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                node_array.push(o);\n                var ci = node.children.length;\n                for (var i = 0; i < ci; i++) {\n                    df._array_node(node.children[i], node_array);\n                }\n            },\n        },\n\n        freemind: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"freemind\",\n                \"data\": \"<map version=\\\"1.0.1\\\"><node ID=\\\"root\\\" TEXT=\\\"freemind Example\\\"/></map>\"\n            },\n            get_mind: function (source) {\n                var df = jm.format.freemind;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                var xml = source.data;\n                var xml_doc = df._parse_xml(xml);\n                var xml_root = df._find_root(xml_doc);\n                df._load_node(mind, null, xml_root);\n                return mind;\n            },\n\n            get_data: function (mind) {\n                var df = jm.format.freemind;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'freemind';\n                var xmllines = [];\n                xmllines.push('<map version=\\\"1.0.1\\\">');\n                df._buildmap(mind.root, xmllines);\n                xmllines.push('</map>');\n                json.data = xmllines.join(' ');\n                return json;\n            },\n\n            _parse_xml: function (xml) {\n                var xml_doc = null;\n                if (window.DOMParser) {\n                    var parser = new DOMParser();\n                    xml_doc = parser.parseFromString(xml, 'text/xml');\n                } else { // Internet Explorer\n                    xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n                    xml_doc.async = false;\n                    xml_doc.loadXML(xml);\n                }\n                return xml_doc;\n            },\n\n            _find_root: function (xml_doc) {\n                var nodes = xml_doc.childNodes;\n                var node = null;\n                var root = null;\n                var n = null;\n                for (var i = 0; i < nodes.length; i++) {\n                    n = nodes[i];\n                    if (n.nodeType == 1 && n.tagName == 'map') {\n                        node = n;\n                        break;\n                    }\n                }\n                if (!!node) {\n                    var ns = node.childNodes;\n                    node = null;\n                    for (var i = 0; i < ns.length; i++) {\n                        n = ns[i];\n                        if (n.nodeType == 1 && n.tagName == 'node') {\n                            node = n;\n                            break;\n                        }\n                    }\n                }\n                return node;\n            },\n\n            _load_node: function (mind, parent_id, xml_node) {\n                var df = jm.format.freemind;\n                var node_id = xml_node.getAttribute('ID');\n                var node_topic = xml_node.getAttribute('TEXT');\n                // look for richcontent\n                if (node_topic == null) {\n                    var topic_children = xml_node.childNodes;\n                    var topic_child = null;\n                    for (var i = 0; i < topic_children.length; i++) {\n                        topic_child = topic_children[i];\n                        //logger.debug(topic_child.tagName);\n                        if (topic_child.nodeType == 1 && topic_child.tagName === 'richcontent') {\n                            node_topic = topic_child.textContent;\n                            break;\n                        }\n                    }\n                }\n                var node_data = df._load_attributes(xml_node);\n                var node_expanded = ('expanded' in node_data) ? (node_data.expanded == 'true') : true;\n                delete node_data.expanded;\n\n                var node_position = xml_node.getAttribute('POSITION');\n                var node_direction = null;\n                if (!!node_position) {\n                    node_direction = node_position == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                //logger.debug(node_position +':'+ node_direction);\n                if (!!parent_id) {\n                    mind.add_node(parent_id, node_id, node_topic, node_data, null, node_direction, node_expanded);\n                } else {\n                    mind.set_root(node_id, node_topic, node_data);\n                }\n                var children = xml_node.childNodes;\n                var child = null;\n                for (var i = 0; i < children.length; i++) {\n                    child = children[i];\n                    if (child.nodeType == 1 && child.tagName == 'node') {\n                        df._load_node(mind, node_id, child);\n                    }\n                }\n            },\n\n            _load_attributes: function (xml_node) {\n                var children = xml_node.childNodes;\n                var attr = null;\n                var attr_data = {};\n                for (var i = 0; i < children.length; i++) {\n                    attr = children[i];\n                    if (attr.nodeType == 1 && attr.tagName === 'attribute') {\n                        attr_data[attr.getAttribute('NAME')] = attr.getAttribute('VALUE');\n                    }\n                }\n                return attr_data;\n            },\n\n            _buildmap: function (node, xmllines) {\n                var df = jm.format.freemind;\n                var pos = null;\n                if (!!node.parent && node.parent.isroot) {\n                    pos = node.direction === jm.direction.left ? 'left' : 'right';\n                }\n                xmllines.push('<node');\n                xmllines.push('ID=\\\"' + node.id + '\\\"');\n                if (!!pos) {\n                    xmllines.push('POSITION=\\\"' + pos + '\\\"');\n                }\n                xmllines.push('TEXT=\\\"' + node.topic + '\\\">');\n\n                // store expanded status as an attribute\n                xmllines.push('<attribute NAME=\\\"expanded\\\" VALUE=\\\"' + node.expanded + '\\\"/>');\n\n                // for attributes\n                var node_data = node.data;\n                if (node_data != null) {\n                    for (var k in node_data) {\n                        xmllines.push('<attribute NAME=\\\"' + k + '\\\" VALUE=\\\"' + node_data[k] + '\\\"/>');\n                    }\n                }\n\n                // for children\n                var children = node.children;\n                for (var i = 0; i < children.length; i++) {\n                    df._buildmap(children[i], xmllines);\n                }\n\n                xmllines.push('</node>');\n            },\n        },\n    };\n\n    // ============= utility object =============================================\n\n    jm.util = {\n        is_node: function (node) {\n            return !!node && node instanceof jm.node;\n        },\n        ajax: {\n            _xhr: function () {\n                var xhr = null;\n                if (window.XMLHttpRequest) {\n                    xhr = new XMLHttpRequest();\n                } else {\n                    try {\n                        xhr = new ActiveXObject('Microsoft.XMLHTTP');\n                    } catch (e) { }\n                }\n                return xhr;\n            },\n            _eurl: function (url) {\n                return encodeURIComponent(url);\n            },\n            request: function (url, param, method, callback, fail_callback) {\n                var a = jm.util.ajax;\n                var p = null;\n                var tmp_param = [];\n                for (var k in param) {\n                    tmp_param.push(a._eurl(k) + '=' + a._eurl(param[k]));\n                }\n                if (tmp_param.length > 0) {\n                    p = tmp_param.join('&');\n                }\n                var xhr = a._xhr();\n                if (!xhr) { return; }\n                xhr.onreadystatechange = function () {\n                    if (xhr.readyState == 4) {\n                        if (xhr.status == 200 || xhr.status == 0) {\n                            if (typeof callback === 'function') {\n                                var data = jm.util.json.string2json(xhr.responseText);\n                                if (data != null) {\n                                    callback(data);\n                                } else {\n                                    callback(xhr.responseText);\n                                }\n                            }\n                        } else {\n                            if (typeof fail_callback === 'function') {\n                                fail_callback(xhr);\n                            } else {\n                                logger.error('xhr request failed.', xhr);\n                            }\n                        }\n                    }\n                }\n                method = method || 'GET';\n                xhr.open(method, url, true);\n                xhr.setRequestHeader('If-Modified-Since', '0');\n                if (method == 'POST') {\n                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8');\n                    xhr.send(p);\n                } else {\n                    xhr.send();\n                }\n            },\n            get: function (url, callback) {\n                return jm.util.ajax.request(url, {}, 'GET', callback);\n            },\n            post: function (url, param, callback) {\n                return jm.util.ajax.request(url, param, 'POST', callback);\n            }\n        },\n\n        dom: {\n            //target,eventType,handler\n            add_event: function (t, e, h) {\n                if (!!t.addEventListener) {\n                    t.addEventListener(e, h, false);\n                } else {\n                    t.attachEvent('on' + e, h);\n                }\n            }\n        },\n\n        canvas: {\n            bezierto: function (ctx, x1, y1, x2, y2) {\n                ctx.beginPath();\n                ctx.moveTo(x1, y1);\n                ctx.bezierCurveTo(x1 + (x2 - x1) * 2 / 3, y1, x1, y2, x2, y2);\n                ctx.stroke();\n            },\n            lineto: function (ctx, x1, y1, x2, y2) {\n                ctx.beginPath();\n                ctx.moveTo(x1, y1);\n                ctx.lineTo(x2, y2);\n                ctx.stroke();\n            },\n            clear: function (ctx, x, y, w, h) {\n                ctx.clearRect(x, y, w, h);\n            }\n        },\n\n        file: {\n            read: function (file_data, fn_callback) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    if (typeof fn_callback === 'function') {\n                        fn_callback(this.result, file_data.name);\n                    }\n                };\n                reader.readAsText(file_data);\n            },\n\n            save: function (file_data, type, name) {\n                var blob;\n                if (typeof $w.Blob === 'function') {\n                    blob = new Blob([file_data], { type: type });\n                } else {\n                    var BlobBuilder = $w.BlobBuilder || $w.MozBlobBuilder || $w.WebKitBlobBuilder || $w.MSBlobBuilder;\n                    var bb = new BlobBuilder();\n                    bb.append(file_data);\n                    blob = bb.getBlob(type);\n                }\n                if (navigator.msSaveBlob) {\n                    navigator.msSaveBlob(blob, name);\n                } else {\n                    var URL = $w.URL || $w.webkitURL;\n                    var bloburl = URL.createObjectURL(blob);\n                    var anchor = $c('a');\n                    if ('download' in anchor) {\n                        anchor.style.visibility = 'hidden';\n                        anchor.href = bloburl;\n                        anchor.download = name;\n                        $d.body.appendChild(anchor);\n                        var evt = $d.createEvent('MouseEvents');\n                        evt.initEvent('click', true, true);\n                        anchor.dispatchEvent(evt);\n                        $d.body.removeChild(anchor);\n                    } else {\n                        location.href = bloburl;\n                    }\n                }\n            }\n        },\n\n        json: {\n            json2string: function (json) {\n                if (!!JSON) {\n                    try {\n                        var json_str = JSON.stringify(json);\n                        return json_str;\n                    } catch (e) {\n                        logger.warn(e);\n                        logger.warn('can not convert to string');\n                        return null;\n                    }\n                }\n            },\n            string2json: function (json_str) {\n                if (!!JSON) {\n                    try {\n                        var json = JSON.parse(json_str);\n                        return json;\n                    } catch (e) {\n                        logger.warn(e);\n                        logger.warn('can not parse to json');\n                        return null;\n                    }\n                }\n            },\n            merge: function (b, a) {\n                for (var o in a) {\n                    if (o in b) {\n                        if (typeof b[o] === 'object' &&\n                            Object.prototype.toString.call(b[o]).toLowerCase() == '[object object]' &&\n                            !b[o].length) {\n                            jm.util.json.merge(b[o], a[o]);\n                        } else {\n                            b[o] = a[o];\n                        }\n                    } else {\n                        b[o] = a[o];\n                    }\n                }\n                return b;\n            }\n        },\n\n        uuid: {\n            newid: function () {\n                return (new Date().getTime().toString(16) + Math.random().toString(16).substr(2)).substr(2, 16);\n            }\n        },\n\n        text: {\n            is_empty: function (s) {\n                if (!s) { return true; }\n                return s.replace(/\\s*/, '').length == 0;\n            }\n        }\n    };\n\n    jm.prototype = {\n        init: function () {\n            if (this.inited) { return; }\n            this.inited = true;\n\n            var opts = this.options;\n\n            var opts_layout = {\n                mode: opts.mode,\n                hspace: opts.layout.hspace,\n                vspace: opts.layout.vspace,\n                pspace: opts.layout.pspace\n            }\n            var opts_view = {\n                container: opts.container,\n                support_html: opts.support_html,\n                hmargin: opts.view.hmargin,\n                vmargin: opts.view.vmargin,\n                line_width: opts.view.line_width,\n                line_color: opts.view.line_color\n            };\n            // create instance of function provider\n            this.data = new jm.data_provider(this);\n            this.layout = new jm.layout_provider(this, opts_layout);\n            this.view = new jm.view_provider(this, opts_view);\n            this.shortcut = new jm.shortcut_provider(this, opts.shortcut);\n\n            this.data.init();\n            this.layout.init();\n            this.view.init();\n            this.shortcut.init();\n\n            this._event_bind();\n\n            jm.init_plugins(this);\n        },\n\n        enable_edit: function () {\n            this.options.editable = true;\n        },\n\n        disable_edit: function () {\n            this.options.editable = false;\n        },\n\n        // call enable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        enable_event_handle: function (event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = true;\n        },\n\n        // call disable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        disable_event_handle: function (event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = false;\n        },\n\n        get_editable: function () {\n            return this.options.editable;\n        },\n\n        set_theme: function (theme) {\n            var theme_old = this.options.theme;\n            this.options.theme = (!!theme) ? theme : null;\n            if (theme_old != this.options.theme) {\n                this.view.reset_theme();\n                this.view.reset_custom_style();\n            }\n        },\n        _event_bind: function () {\n            this.view.add_event(this, 'mousedown', this.mousedown_handle);\n            this.view.add_event(this, 'click', this.click_handle);\n            this.view.add_event(this, 'dblclick', this.dblclick_handle);\n        },\n\n        mousedown_handle: function (e) {\n            if (!this.options.default_event_handle['enable_mousedown_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var nodeid = this.view.get_binded_nodeid(element);\n            if (!!nodeid) {\n                this.select_node(nodeid);\n            } else {\n                this.select_clear();\n            }\n        },\n\n        click_handle: function (e) {\n            if (!this.options.default_event_handle['enable_click_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var isexpander = this.view.is_expander(element);\n            if (isexpander) {\n                var nodeid = this.view.get_binded_nodeid(element);\n                if (!!nodeid) {\n                    this.toggle_node(nodeid);\n                }\n            }\n        },\n\n        dblclick_handle: function (e) {\n            if (!this.options.default_event_handle['enable_dblclick_handle']) {\n                return;\n            }\n            if (this.get_editable()) {\n                var element = e.target || event.srcElement;\n                var nodeid = this.view.get_binded_nodeid(element);\n                // if (!!nodeid) { //elva注释掉了，2019.10.11\n                //     this.begin_edit(nodeid);\n                // }\n            }\n        },\n\n        begin_edit: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.begin_edit(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                this.view.edit_node_begin(node);\n            } else {\n                logger.error('fail, this mind map is not editable.');\n                return;\n            }\n        },\n\n        end_edit: function () {\n            this.view.edit_node_end();\n        },\n\n        toggle_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.toggle_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.toggle_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.expand_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.expand_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        collapse_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.collapse_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.collapse_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_all: function () {\n            this.layout.expand_all();\n            this.view.relayout();\n        },\n\n        collapse_all: function () {\n            this.layout.collapse_all();\n            this.view.relayout();\n        },\n\n        expand_to_depth: function (depth) {\n            this.layout.expand_to_depth(depth);\n            this.view.relayout();\n        },\n\n        _reset: function () {\n            this.view.reset();\n            this.layout.reset();\n            this.data.reset();\n        },\n\n        _show: function (mind) {\n            var m = mind || jm.format.node_array.example;\n\n            this.mind = this.data.load(m);\n            if (!this.mind) {\n                logger.error('data.load error');\n                return;\n            } else {\n                logger.debug('data.load ok');\n            }\n\n            this.view.load();\n            logger.debug('view.load ok');\n\n            this.layout.layout();\n            logger.debug('layout.layout ok');\n\n            this.view.show(true);\n            logger.debug('view.show ok');\n\n            this.invoke_event_handle(jm.event_type.show, { data: [mind] });\n        },\n\n        show: function (mind) {\n            this._reset();\n            this._show(mind);\n        },\n\n        get_meta: function () {\n            return {\n                name: this.mind.name,\n                author: this.mind.author,\n                version: this.mind.version\n            };\n        },\n\n        get_data: function (data_format) {\n            var df = data_format || 'node_tree';\n            return this.data.get_data(df);\n        },\n\n        get_root: function () {\n            return this.mind.root;\n        },\n\n        get_node: function (nodeid) {\n            return this.mind.get_node(nodeid);\n        },\n\n        add_node: function (parent_node, nodeid, topic, data) {\n            if (this.get_editable()) {\n                var node = this.mind.add_node(parent_node, nodeid, topic, data);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.view.reset_node_custom_style(node);\n                    this.expand_node(parent_node);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'add_node', data: [parent_node.id, nodeid, topic, data], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_before: function (node_before, nodeid, topic, data) {\n            if (this.get_editable()) {\n                var beforeid = jm.util.is_node(node_before) ? node_before.id : node_before;\n                var node = this.mind.insert_node_before(node_before, nodeid, topic, data);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_before', data: [beforeid, nodeid, topic, data], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_after: function (node_after, nodeid, topic, data) {\n            if (this.get_editable()) {\n                var afterid = jm.util.is_node(node_after) ? node_after.id : node_after;\n                var node = this.mind.insert_node_after(node_after, nodeid, topic, data);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_after', data: [afterid, nodeid, topic, data], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        remove_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.remove_node(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                if (node.isroot) {\n                    logger.error('fail, can not remove root node');\n                    return false;\n                }\n                var nodeid = node.id;\n                var parentid = node.parent.id;\n                var parent_node = this.get_node(parentid);\n                this.view.save_location(parent_node);\n                this.view.remove_node(node);\n                this.mind.remove_node(node);\n                this.layout.layout();\n                this.view.show(false);\n                this.view.restore_location(parent_node);\n                this.invoke_event_handle(jm.event_type.edit, { evt: 'remove_node', data: [nodeid], node: parentid });\n                return true;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return false;\n            }\n        },\n\n        update_node: function (nodeid, topic) {\n            if (this.get_editable()) {\n                if (jm.util.text.is_empty(topic)) {\n                    logger.warn('fail, topic can not be empty');\n                    return;\n                }\n                var node = this.get_node(nodeid);\n                if (!!node) {\n                    if (node.topic === topic) {\n                        logger.info('nothing changed');\n                        this.view.update_node(node);\n                        return;\n                    }\n                    node.topic = topic;\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'update_node', data: [nodeid, topic], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        move_node: function (nodeid, beforeid, parentid, direction) {\n            if (this.get_editable()) {\n                var node = this.mind.move_node(nodeid, beforeid, parentid, direction);\n                if (!!node) {\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'move_node', data: [nodeid, beforeid, parentid, direction], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        select_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.select_node(the_node);\n                }\n            }\n            if (!this.layout.is_visible(node)) {\n                return;\n            }\n            this.mind.selected = node;\n            this.view.select_node(node);\n        },\n\n        get_selected_node: function () {\n            if (!!this.mind) {\n                return this.mind.selected;\n            } else {\n                return null;\n            }\n        },\n\n        select_clear: function () {\n            if (!!this.mind) {\n                this.mind.selected = null;\n                this.view.select_clear();\n            }\n        },\n\n        is_node_visible: function (node) {\n            return this.layout.is_visible(node);\n        },\n\n        find_node_before: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_before(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var prev = null;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (node.id === ni.id) {\n                            n = prev;\n                        }\n                        prev = ni;\n                    }\n                }\n            } else {\n                n = this.mind.get_node_before(node);\n            }\n            return n;\n        },\n\n        find_node_after: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_after(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var getthis = false;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (getthis) {\n                            n = ni;\n                            break;\n                        }\n                        if (node.id === ni.id) {\n                            getthis = true;\n                        }\n                    }\n                }\n            } else {\n                n = this.mind.get_node_after(node);\n            }\n            return n;\n        },\n\n        set_node_color: function (nodeid, bgcolor, fgcolor) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!bgcolor) {\n                        node.data['background-color'] = bgcolor;\n                    }\n                    if (!!fgcolor) {\n                        node.data['foreground-color'] = fgcolor;\n                    }\n                    this.view.reset_node_custom_style(node);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_font_style: function (nodeid, size, weight, style) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!size) {\n                        node.data['font-size'] = size;\n                    }\n                    if (!!weight) {\n                        node.data['font-weight'] = weight;\n                    }\n                    if (!!style) {\n                        node.data['font-style'] = style;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_image: function (nodeid, image, width, height, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!image) {\n                        node.data['background-image'] = image;\n                    }\n                    if (!!width) {\n                        node.data['width'] = width;\n                    }\n                    if (!!height) {\n                        node.data['height'] = height;\n                    }\n                    if (!!rotation) {\n                        node.data['background-rotation'] = rotation;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_rotation: function (nodeid, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!node.data['background-image']) {\n                        logger.error('fail, only can change rotation angle of node with background image');\n                        return null;\n                    }\n                    node.data['background-rotation'] = rotation;\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        resize: function () {\n            this.view.resize();\n        },\n\n        // callback(type ,data)\n        add_event_listener: function (callback) {\n            if (typeof callback === 'function') {\n                this.event_handles.push(callback);\n            }\n        },\n\n        invoke_event_handle: function (type, data) {\n            var j = this;\n            $w.setTimeout(function () {\n                j._invoke_event_handle(type, data);\n            }, 0);\n        },\n\n        _invoke_event_handle: function (type, data) {\n            var l = this.event_handles.length;\n            for (var i = 0; i < l; i++) {\n                this.event_handles[i](type, data);\n            }\n        }\n\n    };\n\n    // ============= data provider =============================================\n\n    jm.data_provider = function (jm) {\n        this.jm = jm;\n    };\n\n    jm.data_provider.prototype = {\n        init: function () {\n            logger.debug('data.init');\n        },\n\n        reset: function () {\n            logger.debug('data.reset');\n        },\n\n        load: function (mind_data) {\n            var df = null;\n            var mind = null;\n            if (typeof mind_data === 'object') {\n                if (!!mind_data.format) {\n                    df = mind_data.format;\n                } else {\n                    df = 'node_tree';\n                }\n            } else {\n                df = 'freemind';\n            }\n\n            if (df == 'node_array') {\n                mind = jm.format.node_array.get_mind(mind_data);\n            } else if (df == 'node_tree') {\n                mind = jm.format.node_tree.get_mind(mind_data);\n            } else if (df == 'freemind') {\n                mind = jm.format.freemind.get_mind(mind_data);\n            } else {\n                logger.warn('unsupported format');\n            }\n            return mind;\n        },\n\n        get_data: function (data_format) {\n            var data = null;\n            if (data_format == 'node_array') {\n                data = jm.format.node_array.get_data(this.jm.mind);\n            } else if (data_format == 'node_tree') {\n                data = jm.format.node_tree.get_data(this.jm.mind);\n            } else if (data_format == 'freemind') {\n                data = jm.format.freemind.get_data(this.jm.mind);\n            } else {\n                logger.error('unsupported ' + data_format + ' format');\n            }\n            return data;\n        },\n    };\n\n    // ============= layout provider ===========================================\n\n    jm.layout_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.isside = (this.opts.mode == 'side');\n        this.bounds = null;\n\n        this.cache_valid = false;\n    };\n\n    jm.layout_provider.prototype = {\n        init: function () {\n            logger.debug('layout.init');\n        },\n        reset: function () {\n            logger.debug('layout.reset');\n            this.bounds = { n: 0, s: 0, w: 0, e: 0 };\n        },\n        layout: function () {\n            logger.debug('layout.layout');\n            this.layout_direction();\n            this.layout_offset();\n        },\n\n        layout_direction: function () {\n            this._layout_direction_root();\n        },\n\n        _layout_direction_root: function () {\n            var node = this.jm.mind.root;\n            // logger.debug(node);\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n            layout_data.direction = jm.direction.center;\n            layout_data.side_index = 0;\n            if (this.isside) {\n                var i = children_count;\n                while (i--) {\n                    this._layout_direction_side(children[i], jm.direction.right, i);\n                }\n            } else {\n                var i = children_count;\n                var subnode = null;\n                while (i--) {\n                    subnode = children[i];\n                    if (subnode.direction == jm.direction.left) {\n                        this._layout_direction_side(subnode, jm.direction.left, i);\n                    } else {\n                        this._layout_direction_side(subnode, jm.direction.right, i);\n                    }\n                }\n                /*\n                var boundary = Math.ceil(children_count/2);\n                var i = children_count;\n                while(i--){\n                    if(i>=boundary){\n                        this._layout_direction_side(children[i],jm.direction.left, children_count-i-1);\n                    }else{\n                        this._layout_direction_side(children[i],jm.direction.right, i);\n                    }\n                }*/\n\n            }\n        },\n\n        _layout_direction_side: function (node, direction, side_index) {\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n\n            layout_data.direction = direction;\n            layout_data.side_index = side_index;\n            var i = children_count;\n            while (i--) {\n                this._layout_direction_side(children[i], direction, i);\n            }\n        },\n\n        layout_offset: function () {\n            var node = this.jm.mind.root;\n            var layout_data = node._data.layout;\n            layout_data.offset_x = 0;\n            layout_data.offset_y = 0;\n            layout_data.outer_height = 0;\n            var children = node.children;\n            var i = children.length;\n            var left_nodes = [];\n            var right_nodes = [];\n            var subnode = null;\n            while (i--) {\n                subnode = children[i];\n                if (subnode._data.layout.direction == jm.direction.right) {\n                    right_nodes.unshift(subnode);\n                } else {\n                    left_nodes.unshift(subnode);\n                }\n            }\n            layout_data.left_nodes = left_nodes;\n            layout_data.right_nodes = right_nodes;\n            layout_data.outer_height_left = this._layout_offset_subnodes(left_nodes);\n            layout_data.outer_height_right = this._layout_offset_subnodes(right_nodes);\n            this.bounds.e = node._data.view.width / 2;\n            this.bounds.w = 0 - this.bounds.e;\n            //logger.debug(this.bounds.w);\n            this.bounds.n = 0;\n            this.bounds.s = Math.max(layout_data.outer_height_left, layout_data.outer_height_right);\n        },\n\n        // layout both the x and y axis\n        _layout_offset_subnodes: function (nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                    this.set_visible(node.children, false);\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                layout_data.offset_x = this.opts.hspace * layout_data.direction + pd.view.width * (pd.layout.direction + layout_data.direction) / 2;\n                if (!node.parent.isroot) {\n                    layout_data.offset_x += this.opts.pspace * layout_data.direction;\n                }\n\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n            }\n            return total_height;\n        },\n\n        // layout the y axis only, for collapse/expand a node\n        _layout_offset_subnodes_height: function (nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes_height(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n                //logger.debug(node.topic);\n                //logger.debug(node._data.layout.offset_y);\n            }\n            return total_height;\n        },\n\n        get_node_offset: function (node) {\n            var layout_data = node._data.layout;\n            var offset_cache = null;\n            if (('_offset_' in layout_data) && this.cache_valid) {\n                offset_cache = layout_data._offset_;\n            } else {\n                offset_cache = { x: -1, y: -1 };\n                layout_data._offset_ = offset_cache;\n            }\n            if (offset_cache.x == -1 || offset_cache.y == -1) {\n                var x = layout_data.offset_x;\n                var y = layout_data.offset_y;\n                if (!node.isroot) {\n                    var offset_p = this.get_node_offset(node.parent);\n                    x += offset_p.x;\n                    y += offset_p.y;\n                }\n                offset_cache.x = x;\n                offset_cache.y = y;\n            }\n            return offset_cache;\n        },\n\n        get_node_point: function (node) {\n            var view_data = node._data.view;\n            var offset_p = this.get_node_offset(node);\n            //logger.debug(offset_p);\n            var p = {};\n            p.x = offset_p.x + view_data.width * (node._data.layout.direction - 1) / 2;\n            p.y = offset_p.y - view_data.height / 2;\n            //logger.debug(p);\n            return p;\n        },\n\n        get_node_point_in: function (node) {\n            var p = this.get_node_offset(node);\n            return p;\n        },\n\n        get_node_point_out: function (node) {\n            var layout_data = node._data.layout;\n            var pout_cache = null;\n            if (('_pout_' in layout_data) && this.cache_valid) {\n                pout_cache = layout_data._pout_;\n            } else {\n                pout_cache = { x: -1, y: -1 };\n                layout_data._pout_ = pout_cache;\n            }\n            if (pout_cache.x == -1 || pout_cache.y == -1) {\n                if (node.isroot) {\n                    pout_cache.x = 0;\n                    pout_cache.y = 0;\n                } else {\n                    var view_data = node._data.view;\n                    var offset_p = this.get_node_offset(node);\n                    pout_cache.x = offset_p.x + (view_data.width + this.opts.pspace) * node._data.layout.direction;\n                    pout_cache.y = offset_p.y;\n                    //logger.debug('pout');\n                    //logger.debug(pout_cache);\n                }\n            }\n            return pout_cache;\n        },\n\n        get_expander_point: function (node) {\n            var p = this.get_node_point_out(node);\n            var ex_p = {};\n            if (node._data.layout.direction == jm.direction.right) {\n                ex_p.x = p.x - 13;\n            } else {\n                ex_p.x = p.x;\n            }\n            ex_p.y = p.y - Math.ceil(13 / 2);\n            return ex_p;\n        },\n\n        get_min_size: function () {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pout = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                pout = this.get_node_point_out(node);\n                //logger.debug(pout.x);\n                if (pout.x > this.bounds.e) { this.bounds.e = pout.x; }\n                if (pout.x < this.bounds.w) { this.bounds.w = pout.x; }\n            }\n            return {\n                w: this.bounds.e - this.bounds.w,\n                h: this.bounds.s - this.bounds.n\n            }\n        },\n\n        toggle_node: function (node) {\n            if (node.isroot) {\n                return;\n            }\n            if (node.expanded) {\n                this.collapse_node(node);\n            } else {\n                this.expand_node(node);\n            }\n        },\n\n        expand_node: function (node) {\n            node.expanded = true;\n            this.part_layout(node);\n            this.set_visible(node.children, true);\n        },\n\n        collapse_node: function (node) {\n            node.expanded = false;\n            this.part_layout(node);\n            this.set_visible(node.children, false);\n        },\n\n        expand_all: function () {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!node.expanded) {\n                    node.expanded = true;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        collapse_all: function () {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (node.expanded && !node.isroot) {\n                    node.expanded = false\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        expand_to_depth: function (target_depth, curr_nodes, curr_depth) {\n            if (target_depth < 1) { return; }\n            var nodes = curr_nodes || this.jm.mind.root.children;\n            var depth = curr_depth || 1;\n            var i = nodes.length;\n            var node = null;\n            while (i--) {\n                node = nodes[i];\n                if (depth < target_depth) {\n                    if (!node.expanded) {\n                        this.expand_node(node);\n                    }\n                    this.expand_to_depth(target_depth, node.children, depth + 1);\n                }\n                if (depth == target_depth) {\n                    if (node.expanded) {\n                        this.collapse_node(node);\n                    }\n                }\n            }\n        },\n\n        part_layout: function (node) {\n            var root = this.jm.mind.root;\n            if (!!root) {\n                var root_layout_data = root._data.layout;\n                if (node.isroot) {\n                    root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                } else {\n                    if (node._data.layout.direction == jm.direction.right) {\n                        root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    } else {\n                        root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                    }\n                }\n                this.bounds.s = Math.max(root_layout_data.outer_height_left, root_layout_data.outer_height_right);\n                this.cache_valid = false;\n            } else {\n                logger.warn('can not found root node');\n            }\n        },\n\n        set_visible: function (nodes, visible) {\n            var i = nodes.length;\n            var node = null;\n            var layout_data = null;\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (node.expanded) {\n                    this.set_visible(node.children, visible);\n                } else {\n                    this.set_visible(node.children, false);\n                }\n                if (!node.isroot) {\n                    node._data.layout.visible = visible;\n                }\n            }\n        },\n\n        is_expand: function (node) {\n            return node.expanded;\n        },\n\n        is_visible: function (node) {\n            var layout_data = node._data.layout;\n            if (('visible' in layout_data) && !layout_data.visible) {\n                return false;\n            } else {\n                return true;\n            }\n        },\n    };\n\n    // view provider\n    jm.view_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.layout = jm.layout;\n\n        this.container = null;\n        this.e_panel = null;\n        this.e_nodes = null;\n        this.e_canvas = null;\n\n        this.canvas_ctx = null;\n        this.size = { w: 0, h: 0 };\n\n        this.selected_node = null;\n        this.editing_node = null;\n    };\n\n    jm.view_provider.prototype = {\n        init: function () {\n            logger.debug('view.init');\n\n            this.container = $i(this.opts.container) ? this.opts.container : $g(this.opts.container);\n            if (!this.container) {\n                logger.error('the options.view.container was not be found in dom');\n                return;\n            }\n            this.e_panel = $c('div');\n            this.e_canvas = $c('canvas');\n            this.e_nodes = $c('jmnodes');\n            this.e_editor = $c('input');\n\n            this.e_panel.className = 'jsmind-inner';\n            this.e_panel.appendChild(this.e_canvas);\n            this.e_panel.appendChild(this.e_nodes);\n\n            this.e_editor.className = 'jsmind-editor';\n            this.e_editor.type = 'text';\n\n            this.actualZoom = 1;\n            this.zoomStep = 0.1;\n            this.minZoom = 0.5;\n            this.maxZoom = 2;\n\n            var v = this;\n            jm.util.dom.add_event(this.e_editor, 'keydown', function (e) {\n                var evt = e || event;\n                if (evt.keyCode == 13) { v.edit_node_end(); evt.stopPropagation(); }\n            });\n            jm.util.dom.add_event(this.e_editor, 'blur', function (e) {\n                v.edit_node_end();\n            });\n\n            this.container.appendChild(this.e_panel);\n\n            this.init_canvas();\n        },\n\n        add_event: function (obj, event_name, event_handle) {\n            jm.util.dom.add_event(this.e_nodes, event_name, function (e) {\n                var evt = e || event;\n                event_handle.call(obj, evt);\n            });\n        },\n\n        get_binded_nodeid: function (element) {\n            if (element == null) {\n                return null;\n            }\n            var tagName = element.tagName.toLowerCase();\n            if (tagName == 'jmnodes' || tagName == 'body' || tagName == 'html') {\n                return null;\n            }\n            if (tagName == 'jmnode' || tagName == 'jmexpander') {\n                return element.getAttribute('nodeid');\n            } else {\n                return this.get_binded_nodeid(element.parentElement);\n            }\n        },\n\n        is_expander: function (element) {\n            return (element.tagName.toLowerCase() == 'jmexpander');\n        },\n\n        reset: function () {\n            logger.debug('view.reset');\n            this.selected_node = null;\n            this.clear_lines();\n            this.clear_nodes();\n            this.reset_theme();\n        },\n\n        reset_theme: function () {\n            var theme_name = this.jm.options.theme;\n            if (!!theme_name) {\n                this.e_nodes.className = 'theme-' + theme_name;\n            } else {\n                this.e_nodes.className = '';\n            }\n        },\n\n        reset_custom_style: function () {\n            var nodes = this.jm.mind.nodes;\n            for (var nodeid in nodes) {\n                this.reset_node_custom_style(nodes[nodeid]);\n            }\n        },\n\n        load: function () {\n            logger.debug('view.load');\n            this.init_nodes();\n        },\n\n        expand_size: function () {\n            var min_size = this.layout.get_min_size();\n            var min_width = min_size.w + this.opts.hmargin * 2;\n            var min_height = min_size.h + this.opts.vmargin * 2;\n            var client_w = this.e_panel.clientWidth;\n            var client_h = this.e_panel.clientHeight;\n            if (client_w < min_width) { client_w = min_width; }\n            if (client_h < min_height) { client_h = min_height; }\n            this.size.w = client_w;\n            this.size.h = client_h;\n        },\n\n        init_canvas: function () {\n            var ctx = this.e_canvas.getContext('2d');\n            this.canvas_ctx = ctx;\n        },\n\n        init_nodes_size: function (node) {\n            var view_data = node._data.view;\n            view_data.width = view_data.element.clientWidth;\n            view_data.height = view_data.element.clientHeight;\n        },\n\n        init_nodes: function () {\n            var nodes = this.jm.mind.nodes;\n            var doc_frag = $d.createDocumentFragment();\n            for (var nodeid in nodes) {\n                this.create_node_element(nodes[nodeid], doc_frag);\n            }\n            this.e_nodes.appendChild(doc_frag);\n            for (var nodeid in nodes) {\n                this.init_nodes_size(nodes[nodeid]);\n            }\n        },\n\n        add_node: function (node) {\n            this.create_node_element(node, this.e_nodes);\n            this.init_nodes_size(node);\n        },\n\n        create_node_element: function (node, parent_node) {\n            var view_data = null;\n            if ('view' in node._data) {\n                view_data = node._data.view;\n            } else {\n                view_data = {};\n                node._data.view = view_data;\n            }\n\n            var d = $c('jmnode');\n            if (node.isroot) {\n                d.className = 'root';\n            } else {\n                var d_e = $c('jmexpander');\n                $t(d_e, '-');\n                d_e.setAttribute('nodeid', node.id);\n                d_e.style.visibility = 'hidden';\n                parent_node.appendChild(d_e);\n                view_data.expander = d_e;\n            }\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(d, node.topic);\n                } else {\n                    $t(d, node.topic);\n                }\n            }\n            d.setAttribute('nodeid', node.id);\n            d.style.visibility = 'hidden';\n            this._reset_node_custom_style(d, node.data);\n\n            parent_node.appendChild(d);\n            view_data.element = d;\n        },\n\n        remove_node: function (node) {\n            if (this.selected_node != null && this.selected_node.id == node.id) {\n                this.selected_node = null;\n            }\n            if (this.editing_node != null && this.editing_node.id == node.id) {\n                node._data.view.element.removeChild(this.e_editor);\n                this.editing_node = null;\n            }\n            var children = node.children;\n            var i = children.length;\n            while (i--) {\n                this.remove_node(children[i]);\n            }\n            if (node._data.view) {\n                var element = node._data.view.element;\n                var expander = node._data.view.expander;\n                this.e_nodes.removeChild(element);\n                this.e_nodes.removeChild(expander);\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n        },\n\n        update_node: function (node) {\n            var view_data = node._data.view;\n            var element = view_data.element;\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(element, node.topic);\n                } else {\n                    $t(element, node.topic);\n                }\n            }\n            view_data.width = element.clientWidth;\n            view_data.height = element.clientHeight;\n        },\n\n        select_node: function (node) {\n            if (!!this.selected_node) {\n                this.selected_node._data.view.element.className =\n                    this.selected_node._data.view.element.className.replace(/\\s*selected\\b/i, '');\n                this.reset_node_custom_style(this.selected_node);\n            }\n            if (!!node) {\n                this.selected_node = node;\n                node._data.view.element.className += ' selected';\n                this.clear_node_custom_style(node);\n            }\n        },\n\n        select_clear: function () {\n            this.select_node(null);\n        },\n\n        get_editing_node: function () {\n            return this.editing_node;\n        },\n\n        is_editing: function () {\n            return (!!this.editing_node);\n        },\n\n        edit_node_begin: function (node) {\n            if (!node.topic) {\n                logger.warn(\"don't edit image nodes\");\n                return;\n            }\n            if (this.editing_node != null) {\n                this.edit_node_end();\n            }\n            this.editing_node = node;\n            var view_data = node._data.view;\n            var element = view_data.element;\n            var topic = node.topic;\n            var ncs = getComputedStyle(element);\n            this.e_editor.value = topic;\n            this.e_editor.style.width = (element.clientWidth - parseInt(ncs.getPropertyValue('padding-left')) - parseInt(ncs.getPropertyValue('padding-right'))) + 'px';\n            element.innerHTML = '';\n            element.appendChild(this.e_editor);\n            element.style.zIndex = 5;\n            this.e_editor.focus();\n            this.e_editor.select();\n        },\n\n        edit_node_end: function () {\n            if (this.editing_node != null) {\n                var node = this.editing_node;\n                this.editing_node = null;\n                var view_data = node._data.view;\n                var element = view_data.element;\n                var topic = this.e_editor.value;\n                element.style.zIndex = 'auto';\n                element.removeChild(this.e_editor);\n                if (jm.util.text.is_empty(topic) || node.topic === topic) {\n                    if (this.opts.support_html) {\n                        $h(element, node.topic);\n                    } else {\n                        $t(element, node.topic);\n                    }\n                } else {\n                    this.jm.update_node(node.id, topic);\n                }\n                var myEvent = new Event('edit_node_end');\n                element.dispatchEvent(myEvent);\n            }\n        },\n\n        get_view_offset: function () {\n            var bounds = this.layout.bounds;\n            var _x = (this.size.w - bounds.e - bounds.w) / 2;\n            var _y = this.size.h / 2;\n            return { x: _x, y: _y };\n        },\n\n        resize: function () {\n            this.e_canvas.width = 1;\n            this.e_canvas.height = 1;\n            this.e_nodes.style.width = '1px';\n            this.e_nodes.style.height = '1px';\n\n            this.expand_size();\n            this._show();\n        },\n\n        _show: function () {\n            this.e_canvas.width = this.size.w;\n            this.e_canvas.height = this.size.h;\n            this.e_nodes.style.width = this.size.w + 'px';\n            this.e_nodes.style.height = this.size.h + 'px';\n            this.show_nodes();\n            this.show_lines();\n            //this.layout.cache_valid = true;\n            this.jm.invoke_event_handle(jm.event_type.resize, { data: [] });\n        },\n\n        zoomIn: function () {\n            return this.setZoom(this.actualZoom + this.zoomStep);\n        },\n\n        zoomOut: function () {\n            return this.setZoom(this.actualZoom - this.zoomStep);\n        },\n\n        setZoom: function (zoom) {\n            if ((zoom < this.minZoom) || (zoom > this.maxZoom)) {\n                return false;\n            }\n            this.actualZoom = zoom;\n            for (var i = 0; i < this.e_panel.children.length; i++) {\n                this.e_panel.children[i].style.transform = 'scale(' + zoom + ')';\n            };\n            this.show(true);\n            return true;\n\n        },\n\n        _center_root: function () {\n            // center root node\n            var outer_w = this.e_panel.clientWidth;\n            var outer_h = this.e_panel.clientHeight;\n            if (this.size.w > outer_w) {\n                var _offset = this.get_view_offset();\n                this.e_panel.scrollLeft = _offset.x - outer_w / 2;\n            }\n            if (this.size.h > outer_h) {\n                this.e_panel.scrollTop = (this.size.h - outer_h) / 2;\n            }\n        },\n\n        show: function (keep_center) {\n            logger.debug('view.show');\n            this.expand_size();\n            this._show();\n            if (!!keep_center) {\n                this._center_root();\n            }\n        },\n\n        relayout: function () {\n            this.expand_size();\n            this._show();\n        },\n\n        save_location: function (node) {\n            var vd = node._data.view;\n            vd._saved_location = {\n                x: parseInt(vd.element.style.left) - this.e_panel.scrollLeft,\n                y: parseInt(vd.element.style.top) - this.e_panel.scrollTop,\n            };\n        },\n\n        restore_location: function (node) {\n            var vd = node._data.view;\n            this.e_panel.scrollLeft = parseInt(vd.element.style.left) - vd._saved_location.x;\n            this.e_panel.scrollTop = parseInt(vd.element.style.top) - vd._saved_location.y;\n        },\n\n        clear_nodes: function () {\n            var mind = this.jm.mind;\n            if (mind == null) {\n                return;\n            }\n            var nodes = mind.nodes;\n            var node = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n            this.e_nodes.innerHTML = '';\n        },\n\n        show_nodes: function () {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var node_element = null;\n            var expander = null;\n            var p = null;\n            var p_expander = null;\n            var expander_text = '-';\n            var view_data = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                view_data = node._data.view;\n                node_element = view_data.element;\n                expander = view_data.expander;\n                if (!this.layout.is_visible(node)) {\n                    node_element.style.display = 'none';\n                    expander.style.display = 'none';\n                    continue;\n                }\n                this.reset_node_custom_style(node);\n                p = this.layout.get_node_point(node);\n                view_data.abs_x = _offset.x + p.x;\n                view_data.abs_y = _offset.y + p.y;\n                node_element.style.left = (_offset.x + p.x) + 'px';\n                node_element.style.top = (_offset.y + p.y) + 'px';\n                node_element.style.display = '';\n                node_element.style.visibility = 'visible';\n                if (!node.isroot && node.children.length > 0) {\n                    expander_text = node.expanded ? '-' : '+';\n                    p_expander = this.layout.get_expander_point(node);\n                    expander.style.left = (_offset.x + p_expander.x) + 'px';\n                    expander.style.top = (_offset.y + p_expander.y) + 'px';\n                    expander.style.display = '';\n                    expander.style.visibility = 'visible';\n                    $t(expander, expander_text);\n                }\n                // hide expander while all children have been removed\n                if (!node.isroot && node.children.length == 0) {\n                    expander.style.display = 'none';\n                    expander.style.visibility = 'hidden';\n                }\n            }\n        },\n\n        reset_node_custom_style: function (node) {\n            this._reset_node_custom_style(node._data.view.element, node.data);\n        },\n\n        _reset_node_custom_style: function (node_element, node_data) {\n            if ('background-color' in node_data) {\n                node_element.style.backgroundColor = node_data['background-color'];\n            }\n            if ('foreground-color' in node_data) {\n                node_element.style.color = node_data['foreground-color'];\n            }\n            if ('width' in node_data) {\n                node_element.style.width = node_data['width'] + 'px';\n            }\n            if ('height' in node_data) {\n                node_element.style.height = node_data['height'] + 'px';\n            }\n            if ('font-size' in node_data) {\n                node_element.style.fontSize = node_data['font-size'] + 'px';\n            }\n            if ('font-weight' in node_data) {\n                node_element.style.fontWeight = node_data['font-weight'];\n            }\n            if ('font-style' in node_data) {\n                node_element.style.fontStyle = node_data['font-style'];\n            }\n            if ('background-image' in node_data) {\n                var backgroundImage = node_data['background-image'];\n                if (backgroundImage.startsWith('data') && node_data['width'] && node_data['height']) {\n                    var img = new Image();\n\n                    img.onload = function () {\n                        var c = $c('canvas');\n                        c.width = node_element.clientWidth;\n                        c.height = node_element.clientHeight;\n                        var img = this;\n                        if (c.getContext) {\n                            var ctx = c.getContext('2d');\n                            ctx.drawImage(img, 2, 2, node_element.clientWidth, node_element.clientHeight);\n                            var scaledImageData = c.toDataURL();\n                            node_element.style.backgroundImage = 'url(' + scaledImageData + ')';\n                        }\n                    };\n                    img.src = backgroundImage;\n\n                } else {\n                    node_element.style.backgroundImage = 'url(' + backgroundImage + ')';\n                }\n                node_element.style.backgroundSize = '99%';\n\n                if ('background-rotation' in node_data) {\n                    node_element.style.transform = 'rotate(' + node_data['background-rotation'] + 'deg)';\n                }\n\n            }\n        },\n\n        clear_node_custom_style: function (node) {\n            var node_element = node._data.view.element;\n            node_element.style.backgroundColor = \"\";\n            node_element.style.color = \"\";\n        },\n\n        clear_lines: function (canvas_ctx) {\n            var ctx = canvas_ctx || this.canvas_ctx;\n            jm.util.canvas.clear(ctx, 0, 0, this.size.w, this.size.h);\n        },\n\n        show_lines: function (canvas_ctx) {\n            this.clear_lines(canvas_ctx);\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pin = null;\n            var pout = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!!node.isroot) { continue; }\n                if (('visible' in node._data.layout) && !node._data.layout.visible) { continue; }\n                pin = this.layout.get_node_point_in(node);\n                pout = this.layout.get_node_point_out(node.parent);\n                this.draw_line(pout, pin, _offset, canvas_ctx);\n            }\n        },\n\n        draw_line: function (pin, pout, offset, canvas_ctx) {\n            var ctx = canvas_ctx || this.canvas_ctx;\n            ctx.strokeStyle = this.opts.line_color;\n            ctx.lineWidth = this.opts.line_width;\n            ctx.lineCap = 'round';\n\n            jm.util.canvas.bezierto(\n                ctx,\n                pin.x + offset.x,\n                pin.y + offset.y,\n                pout.x + offset.x,\n                pout.y + offset.y);\n        },\n    };\n\n    // shortcut provider\n    jm.shortcut_provider = function (jm, options) {\n        this.jm = jm;\n        this.opts = options;\n        this.mapping = options.mapping;\n        this.handles = options.handles;\n        this._mapping = {};\n    };\n\n    jm.shortcut_provider.prototype = {\n        init: function () {\n            jm.util.dom.add_event($d, 'keydown', this.handler.bind(this));\n\n            this.handles['addchild'] = this.handle_addchild;\n            this.handles['addbrother'] = this.handle_addbrother;\n            this.handles['editnode'] = this.handle_editnode;\n            this.handles['delnode'] = this.handle_delnode;\n            this.handles['toggle'] = this.handle_toggle;\n            this.handles['up'] = this.handle_up;\n            this.handles['down'] = this.handle_down;\n            this.handles['left'] = this.handle_left;\n            this.handles['right'] = this.handle_right;\n\n            for (var handle in this.mapping) {\n                if (!!this.mapping[handle] && (handle in this.handles)) {\n                    this._mapping[this.mapping[handle]] = this.handles[handle];\n                }\n            }\n        },\n\n        enable_shortcut: function () {\n            this.opts.enable = true;\n        },\n\n        disable_shortcut: function () {\n            this.opts.enable = false;\n        },\n\n        handler: function (e) {\n            if (this.jm.view.is_editing()) { return; }\n            var evt = e || event;\n            if (!this.opts.enable) { return true; }\n            var kc = evt.keyCode;\n            if (kc in this._mapping) {\n                this._mapping[kc].call(this, this.jm, e);\n            }\n        },\n\n        handle_addchild: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var nodeid = jm.util.uuid.newid();\n                var node = _jm.add_node(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_addbrother: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                var nodeid = jm.util.uuid.newid();\n                var node = _jm.insert_node_after(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_editnode: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.begin_edit(selected_node);\n            }\n        },\n        handle_delnode: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                _jm.select_node(selected_node.parent);\n                _jm.remove_node(selected_node);\n            }\n        },\n        handle_toggle: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.toggle_node(selected_node.id);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n        handle_up: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var up_node = _jm.find_node_before(selected_node);\n                if (!up_node) {\n                    var np = _jm.find_node_before(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        up_node = np.children[np.children.length - 1];\n                    }\n                }\n                if (!!up_node) {\n                    _jm.select_node(up_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_down: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var down_node = _jm.find_node_after(selected_node);\n                if (!down_node) {\n                    var np = _jm.find_node_after(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        down_node = np.children[0];\n                    }\n                }\n                if (!!down_node) {\n                    _jm.select_node(down_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_left: function (_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.left);\n        },\n        handle_right: function (_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.right);\n        },\n        _handle_direction: function (_jm, e, d) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            var node = null;\n            if (!!selected_node) {\n                if (selected_node.isroot) {\n                    var c = selected_node.children;\n                    var children = [];\n                    for (var i = 0; i < c.length; i++) {\n                        if (c[i].direction === d) {\n                            children.push(i)\n                        }\n                    }\n                    node = c[children[Math.floor((children.length - 1) / 2)]];\n                }\n                else if (selected_node.direction === d) {\n                    var children = selected_node.children;\n                    var childrencount = children.length;\n                    if (childrencount > 0) {\n                        node = children[Math.floor((childrencount - 1) / 2)]\n                    }\n                } else {\n                    node = selected_node.parent;\n                }\n                if (!!node) {\n                    _jm.select_node(node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n    };\n\n\n    // plugin\n    jm.plugin = function (name, init) {\n        this.name = name;\n        this.init = init;\n    };\n\n    jm.plugins = [];\n\n    jm.register_plugin = function (plugin) {\n        if (plugin instanceof jm.plugin) {\n            jm.plugins.push(plugin);\n        }\n    };\n\n    jm.init_plugins = function (sender) {\n        $w.setTimeout(function () {\n            jm._init_plugins(sender);\n        }, 0);\n    };\n\n    jm._init_plugins = function (sender) {\n        var l = jm.plugins.length;\n        var fn_init = null;\n        for (var i = 0; i < l; i++) {\n            fn_init = jm.plugins[i].init;\n            if (typeof fn_init === 'function') {\n                fn_init(sender);\n            }\n        }\n    };\n\n    // quick way\n    jm.show = function (options, mind) {\n        var _jm = new jm(options);\n        _jm.show(mind);\n        return _jm;\n    };\n\n    // export jsmind\n    if (typeof module !== 'undefined' && typeof exports === 'object') {\n        module.exports = jm;\n    } else if (typeof define === 'function' && (define.amd || define.cmd)) {\n        define(function () { return jm; });\n    } else {\n        $w[__name__] = jm;\n    }\n})(typeof window !== 'undefined' ? window : global);\n\n"],"sourceRoot":""}